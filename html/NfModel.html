<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>NfModel</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">-- A Beth model of normal forms</a>

<a id="34" class="Keyword">open</a> <a id="39" class="Keyword">import</a> <a id="46" href="Library.html" class="Module">Library</a> <a id="54" class="Keyword">hiding</a> <a id="61" class="Symbol">(</a><a id="62" href="Data.List.Membership.Setoid.html#877" class="Function Operator">_∈_</a><a id="65" class="Symbol">;</a> <a id="67" href="Data.List.Relation.Unary.All.html#1274" class="Datatype">All</a><a id="70" class="Symbol">)</a>

<a id="73" class="Keyword">module</a> <a id="80" href="NfModel.html" class="Module">NfModel</a> <a id="88" class="Symbol">(</a><a id="89" href="NfModel.html#89" class="Bound">Base</a> <a id="94" class="Symbol">:</a> <a id="96" class="PrimitiveType">Set</a><a id="99" class="Symbol">)</a> <a id="101" class="Keyword">where</a>

<a id="108" class="Keyword">import</a> <a id="115" href="Formulas.html" class="Module">Formulas</a>   <a id="126" class="Symbol">;</a> <a id="128" class="Keyword">open</a> <a id="133" class="Keyword">module</a> <a id="Form"></a><a id="140" href="NfModel.html#140" class="Module">Form</a> <a id="145" class="Symbol">=</a> <a id="147" href="Formulas.html" class="Module">Formulas</a>    <a id="159" href="NfModel.html#89" class="Bound">Base</a>
<a id="164" class="Keyword">import</a> <a id="171" href="Derivations.html" class="Module">Derivations</a><a id="182" class="Symbol">;</a> <a id="184" class="Keyword">open</a> <a id="189" class="Keyword">module</a> <a id="Der"></a><a id="196" href="NfModel.html#196" class="Module">Der</a>  <a id="201" class="Symbol">=</a> <a id="203" href="Derivations.html" class="Module">Derivations</a> <a id="215" href="NfModel.html#89" class="Bound">Base</a>

<a id="221" class="Comment">-- Beth model</a>

<a id="236" class="Comment">-- A cover for Γ is the skeleton of a case tree that can be formed in Γ.</a>
<a id="309" class="Comment">-- It contains the (neutral) scrutinees we case over and the markers (hole)</a>
<a id="385" class="Comment">-- for the leaves that have to be filled by the branches of the case statement.</a>

<a id="466" class="Keyword">data</a> <a id="Cover"></a><a id="471" href="NfModel.html#471" class="Datatype">Cover</a> <a id="477" class="Symbol">(</a><a id="478" href="NfModel.html#478" class="Bound">Γ</a> <a id="480" class="Symbol">:</a> <a id="482" href="Formulas.html#406" class="Datatype">Cxt</a><a id="485" class="Symbol">)</a> <a id="487" class="Symbol">:</a> <a id="489" class="PrimitiveType">Set</a> <a id="493" class="Keyword">where</a>
  <a id="Cover.hole"></a><a id="501" href="NfModel.html#501" class="InductiveConstructor">hole</a>   <a id="508" class="Symbol">:</a> <a id="510" href="NfModel.html#471" class="Datatype">Cover</a> <a id="516" href="NfModel.html#478" class="Bound">Γ</a>
  <a id="Cover.falseC"></a><a id="520" href="NfModel.html#520" class="InductiveConstructor">falseC</a> <a id="527" class="Symbol">:</a> <a id="529" class="Symbol">(</a><a id="530" href="NfModel.html#530" class="Bound">t</a> <a id="532" class="Symbol">:</a> <a id="534" href="Derivations.html#3137" class="Datatype">Ne</a> <a id="537" href="NfModel.html#478" class="Bound">Γ</a> <a id="539" href="Formulas.html#246" class="InductiveConstructor">False</a><a id="544" class="Symbol">)</a> <a id="546" class="Symbol">→</a> <a id="548" href="NfModel.html#471" class="Datatype">Cover</a> <a id="554" href="NfModel.html#478" class="Bound">Γ</a>
  <a id="Cover.orC"></a><a id="558" href="NfModel.html#558" class="InductiveConstructor">orC</a>    <a id="565" class="Symbol">:</a> <a id="567" class="Symbol">∀{</a><a id="569" href="NfModel.html#569" class="Bound">A</a> <a id="571" href="NfModel.html#571" class="Bound">B</a><a id="572" class="Symbol">}</a> <a id="574" class="Symbol">(</a><a id="575" href="NfModel.html#575" class="Bound">t</a> <a id="577" class="Symbol">:</a> <a id="579" href="Derivations.html#3137" class="Datatype">Ne</a> <a id="582" href="NfModel.html#478" class="Bound">Γ</a> <a id="584" class="Symbol">(</a><a id="585" href="NfModel.html#569" class="Bound">A</a> <a id="587" href="Formulas.html#261" class="InductiveConstructor Operator">∨</a> <a id="589" href="NfModel.html#571" class="Bound">B</a><a id="590" class="Symbol">))</a> <a id="593" class="Symbol">(</a><a id="594" href="NfModel.html#594" class="Bound">c</a> <a id="596" class="Symbol">:</a> <a id="598" href="NfModel.html#471" class="Datatype">Cover</a> <a id="604" class="Symbol">(</a><a id="605" href="NfModel.html#478" class="Bound">Γ</a> <a id="607" href="Formulas.html#434" class="InductiveConstructor Operator">∙</a> <a id="609" href="NfModel.html#569" class="Bound">A</a><a id="610" class="Symbol">))</a> <a id="613" class="Symbol">(</a><a id="614" href="NfModel.html#614" class="Bound">d</a> <a id="616" class="Symbol">:</a> <a id="618" href="NfModel.html#471" class="Datatype">Cover</a> <a id="624" class="Symbol">(</a><a id="625" href="NfModel.html#478" class="Bound">Γ</a> <a id="627" href="Formulas.html#434" class="InductiveConstructor Operator">∙</a> <a id="629" href="NfModel.html#571" class="Bound">B</a><a id="630" class="Symbol">))</a> <a id="633" class="Symbol">→</a> <a id="635" href="NfModel.html#471" class="Datatype">Cover</a> <a id="641" href="NfModel.html#478" class="Bound">Γ</a>

<a id="644" class="Comment">-- Choice of names.</a>
<a id="664" class="Comment">-- hole  : has the same role as the hole-evaluation context (identity).</a>
<a id="736" class="Comment">-- falseC: basically falseE.</a>
<a id="765" class="Comment">-- orC   : basically orE.</a>

<a id="792" class="Comment">-- Given c : Cover Γ, a path p : Δ ∈ c leads us from the root to one of the leaves (hole)</a>
<a id="882" class="Comment">-- of the case tree.  Δ is the context at the leaf.</a>

<a id="935" class="Keyword">data</a> <a id="_∈_"></a><a id="940" href="NfModel.html#940" class="Datatype Operator">_∈_</a> <a id="944" href="NfModel.html#944" class="Bound">Δ</a> <a id="946" class="Symbol">:</a> <a id="948" class="Symbol">({</a><a id="950" href="NfModel.html#950" class="Bound">Γ</a><a id="951" class="Symbol">}</a> <a id="953" class="Symbol">:</a> <a id="955" href="Formulas.html#406" class="Datatype">Cxt</a><a id="958" class="Symbol">)</a> <a id="960" class="Symbol">(</a><a id="961" href="NfModel.html#961" class="Bound">c</a> <a id="963" class="Symbol">:</a> <a id="965" href="NfModel.html#471" class="Datatype">Cover</a> <a id="971" href="NfModel.html#950" class="Bound">Γ</a><a id="972" class="Symbol">)</a> <a id="974" class="Symbol">→</a> <a id="976" class="PrimitiveType">Set</a> <a id="980" class="Keyword">where</a>
  <a id="_∈_.here"></a><a id="988" href="NfModel.html#988" class="InductiveConstructor">here</a>  <a id="994" class="Symbol">:</a> <a id="996" href="NfModel.html#944" class="Bound">Δ</a> <a id="998" href="NfModel.html#940" class="Datatype Operator">∈</a> <a id="1000" href="NfModel.html#501" class="InductiveConstructor">hole</a> <a id="1005" class="Symbol">{</a><a id="1006" href="NfModel.html#944" class="Bound">Δ</a><a id="1007" class="Symbol">}</a>
  <a id="_∈_.left"></a><a id="1011" href="NfModel.html#1011" class="InductiveConstructor">left</a>  <a id="1017" class="Symbol">:</a> <a id="1019" class="Symbol">∀{</a><a id="1021" href="NfModel.html#1021" class="Bound">Γ</a> <a id="1023" href="NfModel.html#1023" class="Bound">A</a> <a id="1025" href="NfModel.html#1025" class="Bound">B</a> <a id="1027" href="NfModel.html#1027" class="Bound">c</a> <a id="1029" href="NfModel.html#1029" class="Bound">d</a><a id="1030" class="Symbol">}</a> <a id="1032" class="Symbol">{</a><a id="1033" href="NfModel.html#1033" class="Bound">t</a> <a id="1035" class="Symbol">:</a> <a id="1037" href="Derivations.html#3137" class="Datatype">Ne</a> <a id="1040" href="NfModel.html#1021" class="Bound">Γ</a> <a id="1042" class="Symbol">(</a><a id="1043" href="NfModel.html#1023" class="Bound">A</a> <a id="1045" href="Formulas.html#261" class="InductiveConstructor Operator">∨</a> <a id="1047" href="NfModel.html#1025" class="Bound">B</a><a id="1048" class="Symbol">)}</a> <a id="1051" class="Symbol">(</a><a id="1052" href="NfModel.html#1052" class="Bound">e</a> <a id="1054" class="Symbol">:</a> <a id="1056" href="NfModel.html#944" class="Bound">Δ</a> <a id="1058" href="NfModel.html#940" class="Datatype Operator">∈</a> <a id="1060" href="NfModel.html#1027" class="Bound">c</a><a id="1061" class="Symbol">)</a> <a id="1063" class="Symbol">→</a> <a id="1065" href="NfModel.html#944" class="Bound">Δ</a> <a id="1067" href="NfModel.html#940" class="Datatype Operator">∈</a> <a id="1069" href="NfModel.html#558" class="InductiveConstructor">orC</a> <a id="1073" href="NfModel.html#1033" class="Bound">t</a> <a id="1075" href="NfModel.html#1027" class="Bound">c</a> <a id="1077" href="NfModel.html#1029" class="Bound">d</a>
  <a id="_∈_.right"></a><a id="1081" href="NfModel.html#1081" class="InductiveConstructor">right</a> <a id="1087" class="Symbol">:</a> <a id="1089" class="Symbol">∀{</a><a id="1091" href="NfModel.html#1091" class="Bound">Γ</a> <a id="1093" href="NfModel.html#1093" class="Bound">A</a> <a id="1095" href="NfModel.html#1095" class="Bound">B</a> <a id="1097" href="NfModel.html#1097" class="Bound">c</a> <a id="1099" href="NfModel.html#1099" class="Bound">d</a><a id="1100" class="Symbol">}</a> <a id="1102" class="Symbol">{</a><a id="1103" href="NfModel.html#1103" class="Bound">t</a> <a id="1105" class="Symbol">:</a> <a id="1107" href="Derivations.html#3137" class="Datatype">Ne</a> <a id="1110" href="NfModel.html#1091" class="Bound">Γ</a> <a id="1112" class="Symbol">(</a><a id="1113" href="NfModel.html#1093" class="Bound">A</a> <a id="1115" href="Formulas.html#261" class="InductiveConstructor Operator">∨</a> <a id="1117" href="NfModel.html#1095" class="Bound">B</a><a id="1118" class="Symbol">)}</a> <a id="1121" class="Symbol">(</a><a id="1122" href="NfModel.html#1122" class="Bound">e</a> <a id="1124" class="Symbol">:</a> <a id="1126" href="NfModel.html#944" class="Bound">Δ</a> <a id="1128" href="NfModel.html#940" class="Datatype Operator">∈</a> <a id="1130" href="NfModel.html#1099" class="Bound">d</a><a id="1131" class="Symbol">)</a> <a id="1133" class="Symbol">→</a> <a id="1135" href="NfModel.html#944" class="Bound">Δ</a> <a id="1137" href="NfModel.html#940" class="Datatype Operator">∈</a> <a id="1139" href="NfModel.html#558" class="InductiveConstructor">orC</a> <a id="1143" href="NfModel.html#1103" class="Bound">t</a> <a id="1145" href="NfModel.html#1097" class="Bound">c</a> <a id="1147" href="NfModel.html#1099" class="Bound">d</a>

<a id="1150" class="Comment">-- Given a case tree c : Cover Γ and a context-indexed set P,</a>
<a id="1212" class="Comment">-- f : All c P  is an assignment of things in  P Δ  to holes</a>
<a id="1273" class="Comment">-- of type Δ reached by pathes e : Δ ∈ c.</a>

<a id="All"></a><a id="1316" href="NfModel.html#1316" class="Function">All</a> <a id="1320" class="Symbol">:</a> <a id="1322" class="Symbol">∀{</a><a id="1324" href="NfModel.html#1324" class="Bound">Γ</a><a id="1325" class="Symbol">}</a> <a id="1327" class="Symbol">(</a><a id="1328" href="NfModel.html#1328" class="Bound">c</a> <a id="1330" class="Symbol">:</a> <a id="1332" href="NfModel.html#471" class="Datatype">Cover</a> <a id="1338" href="NfModel.html#1324" class="Bound">Γ</a><a id="1339" class="Symbol">)</a> <a id="1341" class="Symbol">(</a><a id="1342" href="NfModel.html#1342" class="Bound">P</a> <a id="1344" class="Symbol">:</a> <a id="1346" class="Symbol">(</a><a id="1347" href="NfModel.html#1347" class="Bound">Δ</a> <a id="1349" class="Symbol">:</a> <a id="1351" href="Formulas.html#406" class="Datatype">Cxt</a><a id="1354" class="Symbol">)</a> <a id="1356" class="Symbol">→</a> <a id="1358" class="PrimitiveType">Set</a><a id="1361" class="Symbol">)</a> <a id="1363" class="Symbol">→</a> <a id="1365" class="PrimitiveType">Set</a>
<a id="1369" href="NfModel.html#1316" class="Function">All</a> <a id="1373" href="NfModel.html#1373" class="Bound">c</a> <a id="1375" href="NfModel.html#1375" class="Bound">P</a> <a id="1377" class="Symbol">=</a> <a id="1379" class="Symbol">∀{</a><a id="1381" href="NfModel.html#1381" class="Bound">Δ</a><a id="1382" class="Symbol">}</a> <a id="1384" class="Symbol">(</a><a id="1385" href="NfModel.html#1385" class="Bound">e</a> <a id="1387" class="Symbol">:</a> <a id="1389" href="NfModel.html#1381" class="Bound">Δ</a> <a id="1391" href="NfModel.html#940" class="Datatype Operator">∈</a> <a id="1393" href="NfModel.html#1373" class="Bound">c</a><a id="1394" class="Symbol">)</a> <a id="1396" class="Symbol">→</a> <a id="1398" href="NfModel.html#1375" class="Bound">P</a> <a id="1400" href="NfModel.html#1381" class="Bound">Δ</a>

<a id="1403" class="Comment">-- We can also use All c P with a property P on context,</a>
<a id="1460" class="Comment">-- to express that all holes of c satify P.</a>

<a id="1505" class="Comment">-- We might want to depend on the path e : Δ ∈ c also:</a>

<a id="All&#39;"></a><a id="1561" href="NfModel.html#1561" class="Function">All&#39;</a> <a id="1566" class="Symbol">:</a> <a id="1568" class="Symbol">∀{</a><a id="1570" href="NfModel.html#1570" class="Bound">Γ</a><a id="1571" class="Symbol">}</a> <a id="1573" class="Symbol">(</a><a id="1574" href="NfModel.html#1574" class="Bound">c</a> <a id="1576" class="Symbol">:</a> <a id="1578" href="NfModel.html#471" class="Datatype">Cover</a> <a id="1584" href="NfModel.html#1570" class="Bound">Γ</a><a id="1585" class="Symbol">)</a> <a id="1587" class="Symbol">(</a><a id="1588" href="NfModel.html#1588" class="Bound">P</a> <a id="1590" class="Symbol">:</a> <a id="1592" class="Symbol">∀</a> <a id="1594" class="Symbol">{</a><a id="1595" href="NfModel.html#1595" class="Bound">Δ</a><a id="1596" class="Symbol">}</a> <a id="1598" class="Symbol">(</a><a id="1599" href="NfModel.html#1599" class="Bound">e</a> <a id="1601" class="Symbol">:</a> <a id="1603" href="NfModel.html#1595" class="Bound">Δ</a> <a id="1605" href="NfModel.html#940" class="Datatype Operator">∈</a> <a id="1607" href="NfModel.html#1574" class="Bound">c</a><a id="1608" class="Symbol">)</a> <a id="1610" class="Symbol">→</a> <a id="1612" class="PrimitiveType">Set</a><a id="1615" class="Symbol">)</a> <a id="1617" class="Symbol">→</a> <a id="1619" class="PrimitiveType">Set</a>
<a id="1623" href="NfModel.html#1561" class="Function">All&#39;</a> <a id="1628" href="NfModel.html#1628" class="Bound">c</a> <a id="1630" href="NfModel.html#1630" class="Bound">P</a> <a id="1632" class="Symbol">=</a> <a id="1634" class="Symbol">∀{</a><a id="1636" href="NfModel.html#1636" class="Bound">Δ</a><a id="1637" class="Symbol">}</a> <a id="1639" class="Symbol">(</a><a id="1640" href="NfModel.html#1640" class="Bound">e</a> <a id="1642" class="Symbol">:</a> <a id="1644" href="NfModel.html#1636" class="Bound">Δ</a> <a id="1646" href="NfModel.html#940" class="Datatype Operator">∈</a> <a id="1648" href="NfModel.html#1628" class="Bound">c</a><a id="1649" class="Symbol">)</a> <a id="1651" class="Symbol">→</a> <a id="1653" href="NfModel.html#1630" class="Bound">P</a> <a id="1655" href="NfModel.html#1640" class="Bound">e</a>

<a id="1658" class="Comment">-- If  c : Cover Γ  and  e : Δ ∈ C,  then Δ must be an extension of Γ.</a>
<a id="1729" class="Comment">-- Here, we only prove that it is a thinning.</a>

<a id="coverWk"></a><a id="1776" href="NfModel.html#1776" class="Function">coverWk</a> <a id="1784" class="Symbol">:</a> <a id="1786" class="Symbol">∀{</a><a id="1788" href="NfModel.html#1788" class="Bound">Γ</a><a id="1789" class="Symbol">}</a> <a id="1791" class="Symbol">{</a><a id="1792" href="NfModel.html#1792" class="Bound">c</a> <a id="1794" class="Symbol">:</a> <a id="1796" href="NfModel.html#471" class="Datatype">Cover</a> <a id="1802" href="NfModel.html#1788" class="Bound">Γ</a><a id="1803" class="Symbol">}</a> <a id="1805" class="Symbol">→</a> <a id="1807" href="NfModel.html#1316" class="Function">All</a> <a id="1811" href="NfModel.html#1792" class="Bound">c</a> <a id="1813" class="Symbol">(</a><a id="1814" href="Formulas.html#533" class="Datatype Operator">_≤</a> <a id="1817" href="NfModel.html#1788" class="Bound">Γ</a><a id="1818" class="Symbol">)</a>
<a id="1820" href="NfModel.html#1776" class="Function">coverWk</a> <a id="1828" href="NfModel.html#988" class="InductiveConstructor">here</a>      <a id="1838" class="Symbol">=</a> <a id="1840" href="Formulas.html#667" class="Function">id≤</a>
<a id="1844" href="NfModel.html#1776" class="Function">coverWk</a> <a id="1852" class="Symbol">(</a><a id="1853" href="NfModel.html#1011" class="InductiveConstructor">left</a>  <a id="1859" href="NfModel.html#1859" class="Bound">e</a><a id="1860" class="Symbol">)</a> <a id="1862" class="Symbol">=</a> <a id="1864" href="NfModel.html#1776" class="Function">coverWk</a> <a id="1872" href="NfModel.html#1859" class="Bound">e</a> <a id="1874" href="Formulas.html#752" class="Function Operator">•</a> <a id="1876" href="Formulas.html#580" class="InductiveConstructor">weak</a> <a id="1881" href="Formulas.html#667" class="Function">id≤</a>
<a id="1885" href="NfModel.html#1776" class="Function">coverWk</a> <a id="1893" class="Symbol">(</a><a id="1894" href="NfModel.html#1081" class="InductiveConstructor">right</a> <a id="1900" href="NfModel.html#1900" class="Bound">e</a><a id="1901" class="Symbol">)</a> <a id="1903" class="Symbol">=</a> <a id="1905" href="NfModel.html#1776" class="Function">coverWk</a> <a id="1913" href="NfModel.html#1900" class="Bound">e</a> <a id="1915" href="Formulas.html#752" class="Function Operator">•</a> <a id="1917" href="Formulas.html#580" class="InductiveConstructor">weak</a> <a id="1922" href="Formulas.html#667" class="Function">id≤</a>

<a id="1927" class="Comment">-- We can substitute leaves in the case tree by case trees in turn.</a>
<a id="1995" class="Comment">-- The following is a ``parallel substitution&#39;&#39; operations for covers.</a>

<a id="2067" class="Comment">-- If c : Cover Γ and f is a mapping from the leaves of c to case trees</a>
<a id="2139" class="Comment">-- we can graft f onto c to get a new case tree  transC c f.</a>

<a id="2201" class="Comment">-- Here, the case tree substitution is given as a function from pathes</a>
<a id="2272" class="Comment">-- p : Δ ∈ c  to covers.</a>

<a id="transC"></a><a id="2298" href="NfModel.html#2298" class="Function">transC</a> <a id="2305" class="Symbol">:</a> <a id="2307" class="Symbol">∀{</a><a id="2309" href="NfModel.html#2309" class="Bound">Γ</a><a id="2310" class="Symbol">}</a> <a id="2312" class="Symbol">(</a><a id="2313" href="NfModel.html#2313" class="Bound">c</a> <a id="2315" class="Symbol">:</a> <a id="2317" href="NfModel.html#471" class="Datatype">Cover</a> <a id="2323" href="NfModel.html#2309" class="Bound">Γ</a><a id="2324" class="Symbol">)</a> <a id="2326" class="Symbol">(</a><a id="2327" href="NfModel.html#2327" class="Bound">f</a> <a id="2329" class="Symbol">:</a> <a id="2331" href="NfModel.html#1316" class="Function">All</a> <a id="2335" href="NfModel.html#2313" class="Bound">c</a> <a id="2337" href="NfModel.html#471" class="Datatype">Cover</a><a id="2342" class="Symbol">)</a> <a id="2344" class="Symbol">→</a> <a id="2346" href="NfModel.html#471" class="Datatype">Cover</a> <a id="2352" href="NfModel.html#2309" class="Bound">Γ</a>
<a id="2354" href="NfModel.html#2298" class="Function">transC</a> <a id="2361" href="NfModel.html#501" class="InductiveConstructor">hole</a>        <a id="2373" href="NfModel.html#2373" class="Bound">f</a> <a id="2375" class="Symbol">=</a> <a id="2377" href="NfModel.html#2373" class="Bound">f</a> <a id="2379" href="NfModel.html#988" class="InductiveConstructor">here</a>
<a id="2384" href="NfModel.html#2298" class="Function">transC</a> <a id="2391" class="Symbol">(</a><a id="2392" href="NfModel.html#520" class="InductiveConstructor">falseC</a> <a id="2399" href="NfModel.html#2399" class="Bound">t</a><a id="2400" class="Symbol">)</a>  <a id="2403" href="NfModel.html#2403" class="Bound">f</a> <a id="2405" class="Symbol">=</a> <a id="2407" href="NfModel.html#520" class="InductiveConstructor">falseC</a> <a id="2414" href="NfModel.html#2399" class="Bound">t</a>
<a id="2416" href="NfModel.html#2298" class="Function">transC</a> <a id="2423" class="Symbol">(</a><a id="2424" href="NfModel.html#558" class="InductiveConstructor">orC</a> <a id="2428" href="NfModel.html#2428" class="Bound">t</a> <a id="2430" href="NfModel.html#2430" class="Bound">c</a> <a id="2432" href="NfModel.html#2432" class="Bound">d</a><a id="2433" class="Symbol">)</a> <a id="2435" href="NfModel.html#2435" class="Bound">f</a> <a id="2437" class="Symbol">=</a> <a id="2439" href="NfModel.html#558" class="InductiveConstructor">orC</a> <a id="2443" href="NfModel.html#2428" class="Bound">t</a> <a id="2445" class="Symbol">(</a><a id="2446" href="NfModel.html#2298" class="Function">transC</a> <a id="2453" href="NfModel.html#2430" class="Bound">c</a> <a id="2455" class="Symbol">(</a><a id="2456" href="NfModel.html#2435" class="Bound">f</a> <a id="2458" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2460" href="NfModel.html#1011" class="InductiveConstructor">left</a><a id="2464" class="Symbol">))</a> <a id="2467" class="Symbol">(</a><a id="2468" href="NfModel.html#2298" class="Function">transC</a> <a id="2475" href="NfModel.html#2432" class="Bound">d</a> <a id="2477" class="Symbol">(</a><a id="2478" href="NfModel.html#2435" class="Bound">f</a> <a id="2480" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="2482" href="NfModel.html#1081" class="InductiveConstructor">right</a><a id="2487" class="Symbol">))</a>

<a id="2491" class="Comment">-- Composition of pathes.</a>

<a id="2518" class="Comment">-- Assume a c : Cover Γ and a substitution f : Δ ∈ c → ∁over Δ and a path e : Δ ∈ c.</a>
<a id="2603" class="Comment">-- Then any path p : Φ ∈ f e can be extended to a path q : Φ ∈ transC c f</a>
<a id="2677" class="Comment">-- by essentially concatenating e and p.</a>

<a id="2719" class="Comment">-- Note that we maintain f only for the sake of typing.</a>

<a id="2776" class="Comment">-- trans∈ : ∀{Γ} (c : Cover Γ) (f : All c Cover) →</a>
<a id="2827" class="Comment">--   ∀ {Δ} (e : Δ ∈ c) {Φ} → Φ ∈ f e → Φ ∈ transC c f</a>

<a id="trans∈"></a><a id="2882" href="NfModel.html#2882" class="Function">trans∈</a> <a id="2889" class="Symbol">:</a> <a id="2891" class="Symbol">∀{</a><a id="2893" href="NfModel.html#2893" class="Bound">Γ</a><a id="2894" class="Symbol">}</a> <a id="2896" class="Symbol">(</a><a id="2897" href="NfModel.html#2897" class="Bound">c</a> <a id="2899" class="Symbol">:</a> <a id="2901" href="NfModel.html#471" class="Datatype">Cover</a> <a id="2907" href="NfModel.html#2893" class="Bound">Γ</a><a id="2908" class="Symbol">)</a> <a id="2910" class="Symbol">(</a><a id="2911" href="NfModel.html#2911" class="Bound">f</a> <a id="2913" class="Symbol">:</a> <a id="2915" href="NfModel.html#1316" class="Function">All</a> <a id="2919" href="NfModel.html#2897" class="Bound">c</a> <a id="2921" href="NfModel.html#471" class="Datatype">Cover</a><a id="2926" class="Symbol">)</a> <a id="2928" class="Symbol">→</a>
  <a id="2932" href="NfModel.html#1561" class="Function">All&#39;</a> <a id="2937" href="NfModel.html#2897" class="Bound">c</a> <a id="2939" class="Symbol">λ</a> <a id="2941" class="Symbol">{</a><a id="2942" href="NfModel.html#2942" class="Bound">Δ</a><a id="2943" class="Symbol">}</a> <a id="2945" class="Symbol">(</a><a id="2946" href="NfModel.html#2946" class="Bound">e</a> <a id="2948" class="Symbol">:</a> <a id="2950" href="NfModel.html#2942" class="Bound">Δ</a> <a id="2952" href="NfModel.html#940" class="Datatype Operator">∈</a> <a id="2954" href="NfModel.html#2897" class="Bound">c</a><a id="2955" class="Symbol">)</a> <a id="2957" class="Symbol">→</a> <a id="2959" href="NfModel.html#1316" class="Function">All</a> <a id="2963" class="Symbol">(</a><a id="2964" href="NfModel.html#2911" class="Bound">f</a> <a id="2966" href="NfModel.html#2946" class="Bound">e</a><a id="2967" class="Symbol">)</a> <a id="2969" class="Symbol">(</a><a id="2970" href="NfModel.html#940" class="Datatype Operator">_∈</a> <a id="2973" href="NfModel.html#2298" class="Function">transC</a> <a id="2980" href="NfModel.html#2897" class="Bound">c</a> <a id="2982" href="NfModel.html#2911" class="Bound">f</a><a id="2983" class="Symbol">)</a>
<a id="2985" href="NfModel.html#2882" class="Function">trans∈</a> <a id="2992" href="NfModel.html#501" class="InductiveConstructor">hole</a>        <a id="3004" href="NfModel.html#3004" class="Bound">f</a> <a id="3006" href="NfModel.html#988" class="InductiveConstructor">here</a>      <a id="3016" class="Symbol">=</a> <a id="3018" href="Function.Base.html#615" class="Function">id</a>
<a id="3021" href="NfModel.html#2882" class="Function">trans∈</a> <a id="3028" class="Symbol">(</a><a id="3029" href="NfModel.html#520" class="InductiveConstructor">falseC</a> <a id="3036" href="NfModel.html#3036" class="Bound">t</a><a id="3037" class="Symbol">)</a>  <a id="3040" href="NfModel.html#3040" class="Bound">f</a> <a id="3042" class="Symbol">()</a>
<a id="3045" href="NfModel.html#2882" class="Function">trans∈</a> <a id="3052" class="Symbol">(</a><a id="3053" href="NfModel.html#558" class="InductiveConstructor">orC</a> <a id="3057" href="NfModel.html#3057" class="Bound">t</a> <a id="3059" href="NfModel.html#3059" class="Bound">c</a> <a id="3061" href="NfModel.html#3061" class="Bound">d</a><a id="3062" class="Symbol">)</a> <a id="3064" href="NfModel.html#3064" class="Bound">f</a> <a id="3066" class="Symbol">(</a><a id="3067" href="NfModel.html#1011" class="InductiveConstructor">left</a>  <a id="3073" href="NfModel.html#3073" class="Bound">e</a><a id="3074" class="Symbol">)</a> <a id="3076" class="Symbol">=</a> <a id="3078" href="NfModel.html#1011" class="InductiveConstructor">left</a>  <a id="3084" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="3086" href="NfModel.html#2882" class="Function">trans∈</a> <a id="3093" href="NfModel.html#3059" class="Bound">c</a> <a id="3095" class="Symbol">(</a><a id="3096" href="NfModel.html#3064" class="Bound">f</a> <a id="3098" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="3100" href="NfModel.html#1011" class="InductiveConstructor">left</a> <a id="3105" class="Symbol">)</a> <a id="3107" href="NfModel.html#3073" class="Bound">e</a>
<a id="3109" href="NfModel.html#2882" class="Function">trans∈</a> <a id="3116" class="Symbol">(</a><a id="3117" href="NfModel.html#558" class="InductiveConstructor">orC</a> <a id="3121" href="NfModel.html#3121" class="Bound">t</a> <a id="3123" href="NfModel.html#3123" class="Bound">c</a> <a id="3125" href="NfModel.html#3125" class="Bound">d</a><a id="3126" class="Symbol">)</a> <a id="3128" href="NfModel.html#3128" class="Bound">f</a> <a id="3130" class="Symbol">(</a><a id="3131" href="NfModel.html#1081" class="InductiveConstructor">right</a> <a id="3137" href="NfModel.html#3137" class="Bound">e</a><a id="3138" class="Symbol">)</a> <a id="3140" class="Symbol">=</a> <a id="3142" href="NfModel.html#1081" class="InductiveConstructor">right</a> <a id="3148" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="3150" href="NfModel.html#2882" class="Function">trans∈</a> <a id="3157" href="NfModel.html#3125" class="Bound">d</a> <a id="3159" class="Symbol">(</a><a id="3160" href="NfModel.html#3128" class="Bound">f</a> <a id="3162" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="3164" href="NfModel.html#1081" class="InductiveConstructor">right</a><a id="3169" class="Symbol">)</a> <a id="3171" href="NfModel.html#3137" class="Bound">e</a>

<a id="3174" class="Comment">-- Splitting of pathes.</a>

<a id="3199" class="Comment">-- In a situation similar to the previous lemma:</a>
<a id="3248" class="Comment">-- If we have a path q : Φ ∈ transC c f we can split it into some</a>
<a id="3314" class="Comment">-- e : Δ ∈ c and p : Φ ∈ f e.</a>

<a id="split∈"></a><a id="3345" href="NfModel.html#3345" class="Function">split∈</a> <a id="3352" class="Symbol">:</a> <a id="3354" class="Symbol">∀{</a><a id="3356" href="NfModel.html#3356" class="Bound">Γ</a><a id="3357" class="Symbol">}</a> <a id="3359" class="Symbol">(</a><a id="3360" href="NfModel.html#3360" class="Bound">c</a> <a id="3362" class="Symbol">:</a> <a id="3364" href="NfModel.html#471" class="Datatype">Cover</a> <a id="3370" href="NfModel.html#3356" class="Bound">Γ</a><a id="3371" class="Symbol">)</a> <a id="3373" class="Symbol">(</a><a id="3374" href="NfModel.html#3374" class="Bound">f</a> <a id="3376" class="Symbol">:</a> <a id="3378" href="NfModel.html#1316" class="Function">All</a> <a id="3382" href="NfModel.html#3360" class="Bound">c</a> <a id="3384" href="NfModel.html#471" class="Datatype">Cover</a><a id="3389" class="Symbol">)</a> <a id="3391" class="Symbol">{</a><a id="3392" href="NfModel.html#3392" class="Bound">Φ</a><a id="3393" class="Symbol">}</a> <a id="3395" class="Symbol">(</a><a id="3396" href="NfModel.html#3396" class="Bound">q</a> <a id="3398" class="Symbol">:</a> <a id="3400" href="NfModel.html#3392" class="Bound">Φ</a> <a id="3402" href="NfModel.html#940" class="Datatype Operator">∈</a> <a id="3404" href="NfModel.html#2298" class="Function">transC</a> <a id="3411" href="NfModel.html#3360" class="Bound">c</a> <a id="3413" href="NfModel.html#3374" class="Bound">f</a><a id="3414" class="Symbol">)</a>
  <a id="3418" class="Symbol">→</a> <a id="3420" href="Data.Product.html#1369" class="Function">∃</a> <a id="3422" class="Symbol">λ</a> <a id="3424" href="NfModel.html#3424" class="Bound">Δ</a> <a id="3426" class="Symbol">→</a> <a id="3428" href="Data.Product.html#1369" class="Function">∃</a> <a id="3430" class="Symbol">λ</a> <a id="3432" class="Symbol">(</a><a id="3433" href="NfModel.html#3433" class="Bound">e</a> <a id="3435" class="Symbol">:</a> <a id="3437" href="NfModel.html#3424" class="Bound">Δ</a> <a id="3439" href="NfModel.html#940" class="Datatype Operator">∈</a> <a id="3441" href="NfModel.html#3360" class="Bound">c</a><a id="3442" class="Symbol">)</a> <a id="3444" class="Symbol">→</a> <a id="3446" href="NfModel.html#3392" class="Bound">Φ</a> <a id="3448" href="NfModel.html#940" class="Datatype Operator">∈</a> <a id="3450" href="NfModel.html#3374" class="Bound">f</a> <a id="3452" href="NfModel.html#3433" class="Bound">e</a>
<a id="3454" href="NfModel.html#3345" class="Function">split∈</a> <a id="3461" href="NfModel.html#501" class="InductiveConstructor">hole</a>        <a id="3473" href="NfModel.html#3473" class="Bound">f</a> <a id="3475" href="NfModel.html#3475" class="Bound">q</a> <a id="3477" class="Symbol">=</a> <a id="3479" class="Symbol">_</a> <a id="3481" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="3483" class="Symbol">_</a> <a id="3485" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="3487" href="NfModel.html#3475" class="Bound">q</a>
<a id="3489" href="NfModel.html#3345" class="Function">split∈</a> <a id="3496" class="Symbol">(</a><a id="3497" href="NfModel.html#520" class="InductiveConstructor">falseC</a> <a id="3504" href="NfModel.html#3504" class="Bound">t</a><a id="3505" class="Symbol">)</a>  <a id="3508" href="NfModel.html#3508" class="Bound">f</a> <a id="3510" class="Symbol">()</a>
<a id="3513" href="NfModel.html#3345" class="Function">split∈</a> <a id="3520" class="Symbol">(</a><a id="3521" href="NfModel.html#558" class="InductiveConstructor">orC</a> <a id="3525" href="NfModel.html#3525" class="Bound">t</a> <a id="3527" href="NfModel.html#3527" class="Bound">c</a> <a id="3529" href="NfModel.html#3529" class="Bound">d</a><a id="3530" class="Symbol">)</a> <a id="3532" href="NfModel.html#3532" class="Bound">f</a> <a id="3534" class="Symbol">(</a><a id="3535" href="NfModel.html#1011" class="InductiveConstructor">left</a> <a id="3540" href="NfModel.html#3540" class="Bound">q</a><a id="3541" class="Symbol">)</a> <a id="3543" class="Keyword">with</a> <a id="3548" href="NfModel.html#3345" class="Function">split∈</a> <a id="3555" href="NfModel.html#3527" class="Bound">c</a> <a id="3557" class="Symbol">(</a><a id="3558" href="NfModel.html#3532" class="Bound">f</a> <a id="3560" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="3562" href="NfModel.html#1011" class="InductiveConstructor">left</a><a id="3566" class="Symbol">)</a> <a id="3568" href="NfModel.html#3540" class="Bound">q</a>
<a id="3570" class="Symbol">...</a> <a id="3574" class="Symbol">|</a> <a id="3576" href="NfModel.html#3576" class="Bound">Δ</a> <a id="3578" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="3580" href="NfModel.html#3580" class="Bound">e₁</a> <a id="3583" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="3585" href="NfModel.html#3585" class="Bound">e₂</a> <a id="3588" class="Symbol">=</a> <a id="3590" href="NfModel.html#3576" class="Bound">Δ</a> <a id="3592" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="3594" href="NfModel.html#1011" class="InductiveConstructor">left</a> <a id="3599" href="NfModel.html#3580" class="Bound">e₁</a> <a id="3602" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="3604" href="NfModel.html#3585" class="Bound">e₂</a>
<a id="3607" href="NfModel.html#3345" class="Function">split∈</a> <a id="3614" class="Symbol">(</a><a id="3615" href="NfModel.html#558" class="InductiveConstructor">orC</a> <a id="3619" href="NfModel.html#3619" class="Bound">t</a> <a id="3621" href="NfModel.html#3621" class="Bound">c</a> <a id="3623" href="NfModel.html#3623" class="Bound">d</a><a id="3624" class="Symbol">)</a> <a id="3626" href="NfModel.html#3626" class="Bound">f</a> <a id="3628" class="Symbol">(</a><a id="3629" href="NfModel.html#1081" class="InductiveConstructor">right</a> <a id="3635" href="NfModel.html#3635" class="Bound">q</a><a id="3636" class="Symbol">)</a> <a id="3638" class="Keyword">with</a> <a id="3643" href="NfModel.html#3345" class="Function">split∈</a> <a id="3650" href="NfModel.html#3623" class="Bound">d</a> <a id="3652" class="Symbol">(</a><a id="3653" href="NfModel.html#3626" class="Bound">f</a> <a id="3655" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="3657" href="NfModel.html#1081" class="InductiveConstructor">right</a><a id="3662" class="Symbol">)</a> <a id="3664" href="NfModel.html#3635" class="Bound">q</a>
<a id="3666" class="Symbol">...</a> <a id="3670" class="Symbol">|</a> <a id="3672" href="NfModel.html#3672" class="Bound">Δ</a> <a id="3674" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="3676" href="NfModel.html#3676" class="Bound">e₁</a> <a id="3679" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="3681" href="NfModel.html#3681" class="Bound">e₂</a> <a id="3684" class="Symbol">=</a> <a id="3686" href="NfModel.html#3672" class="Bound">Δ</a> <a id="3688" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="3690" href="NfModel.html#1081" class="InductiveConstructor">right</a> <a id="3696" href="NfModel.html#3676" class="Bound">e₁</a> <a id="3699" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="3701" href="NfModel.html#3681" class="Bound">e₂</a>

<a id="3705" class="Comment">-- Syntactic paste (from Thorsten).</a>

<a id="3742" class="Comment">-- If for each leave e : Δ ∈ c of a case tree c : Cover Γ we have a normal form</a>
<a id="3822" class="Comment">-- f e : Nf Δ A  of type A, grafting these nfs onto c gives us a  Nf Γ A.</a>

<a id="pasteNf"></a><a id="3897" href="NfModel.html#3897" class="Function">pasteNf</a> <a id="3905" class="Symbol">:</a> <a id="3907" class="Symbol">∀{</a><a id="3909" href="NfModel.html#3909" class="Bound">A</a> <a id="3911" href="NfModel.html#3911" class="Bound">Γ</a><a id="3912" class="Symbol">}</a> <a id="3914" class="Symbol">(</a><a id="3915" href="NfModel.html#3915" class="Bound">c</a> <a id="3917" class="Symbol">:</a> <a id="3919" href="NfModel.html#471" class="Datatype">Cover</a> <a id="3925" href="NfModel.html#3911" class="Bound">Γ</a><a id="3926" class="Symbol">)</a> <a id="3928" class="Symbol">(</a><a id="3929" href="NfModel.html#3929" class="Bound">f</a> <a id="3931" class="Symbol">:</a> <a id="3933" href="NfModel.html#1316" class="Function">All</a> <a id="3937" href="NfModel.html#3915" class="Bound">c</a> <a id="3939" class="Symbol">λ</a> <a id="3941" href="NfModel.html#3941" class="Bound">Δ</a> <a id="3943" class="Symbol">→</a> <a id="3945" href="Derivations.html#3373" class="Datatype">Nf</a> <a id="3948" href="NfModel.html#3941" class="Bound">Δ</a> <a id="3950" href="NfModel.html#3909" class="Bound">A</a><a id="3951" class="Symbol">)</a> <a id="3953" class="Symbol">→</a> <a id="3955" href="Derivations.html#3373" class="Datatype">Nf</a> <a id="3958" href="NfModel.html#3911" class="Bound">Γ</a> <a id="3960" href="NfModel.html#3909" class="Bound">A</a>
<a id="3962" href="NfModel.html#3897" class="Function">pasteNf</a> <a id="3970" href="NfModel.html#501" class="InductiveConstructor">hole</a>        <a id="3982" href="NfModel.html#3982" class="Bound">f</a> <a id="3984" class="Symbol">=</a> <a id="3986" href="NfModel.html#3982" class="Bound">f</a> <a id="3988" href="NfModel.html#988" class="InductiveConstructor">here</a>
<a id="3993" href="NfModel.html#3897" class="Function">pasteNf</a> <a id="4001" class="Symbol">(</a><a id="4002" href="NfModel.html#520" class="InductiveConstructor">falseC</a> <a id="4009" href="NfModel.html#4009" class="Bound">t</a><a id="4010" class="Symbol">)</a>  <a id="4013" href="NfModel.html#4013" class="Bound">f</a> <a id="4015" class="Symbol">=</a> <a id="4017" href="Derivations.html#3835" class="InductiveConstructor">falseE</a> <a id="4024" href="NfModel.html#4009" class="Bound">t</a>
<a id="4026" href="NfModel.html#3897" class="Function">pasteNf</a> <a id="4034" class="Symbol">(</a><a id="4035" href="NfModel.html#558" class="InductiveConstructor">orC</a> <a id="4039" href="NfModel.html#4039" class="Bound">t</a> <a id="4041" href="NfModel.html#4041" class="Bound">c</a> <a id="4043" href="NfModel.html#4043" class="Bound">d</a><a id="4044" class="Symbol">)</a> <a id="4046" href="NfModel.html#4046" class="Bound">f</a> <a id="4048" class="Symbol">=</a> <a id="4050" href="Derivations.html#3747" class="InductiveConstructor">orE</a> <a id="4054" href="NfModel.html#4039" class="Bound">t</a> <a id="4056" class="Symbol">(</a><a id="4057" href="NfModel.html#3897" class="Function">pasteNf</a> <a id="4065" href="NfModel.html#4041" class="Bound">c</a> <a id="4067" class="Symbol">(</a><a id="4068" href="NfModel.html#4046" class="Bound">f</a> <a id="4070" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="4072" href="NfModel.html#1011" class="InductiveConstructor">left</a><a id="4076" class="Symbol">))</a> <a id="4079" class="Symbol">(</a><a id="4080" href="NfModel.html#3897" class="Function">pasteNf</a> <a id="4088" href="NfModel.html#4043" class="Bound">d</a> <a id="4090" class="Symbol">(</a><a id="4091" href="NfModel.html#4046" class="Bound">f</a> <a id="4093" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="4095" href="NfModel.html#1081" class="InductiveConstructor">right</a><a id="4100" class="Symbol">))</a>

<a id="4104" class="Comment">-- Weakening covers:  A case tree in Γ can be transported to a thinning Δ</a>
<a id="4178" class="Comment">-- by weakening all the scrutinees.</a>

<a id="4215" class="Comment">-- monC : ∀{Γ Δ} (τ : Δ ≤ Γ) (c : Cover Γ) → Cover Δ</a>
<a id="monC"></a><a id="4268" href="NfModel.html#4268" class="Function">monC</a> <a id="4273" class="Symbol">:</a> <a id="4275" href="Formulas.html#3040" class="Function">Mon</a> <a id="4279" href="NfModel.html#471" class="Datatype">Cover</a>
<a id="4285" href="NfModel.html#4268" class="Function">monC</a> <a id="4290" href="NfModel.html#4290" class="Bound">τ</a> <a id="4292" href="NfModel.html#501" class="InductiveConstructor">hole</a>        <a id="4304" class="Symbol">=</a> <a id="4306" href="NfModel.html#501" class="InductiveConstructor">hole</a>
<a id="4311" href="NfModel.html#4268" class="Function">monC</a> <a id="4316" href="NfModel.html#4316" class="Bound">τ</a> <a id="4318" class="Symbol">(</a><a id="4319" href="NfModel.html#520" class="InductiveConstructor">falseC</a> <a id="4326" href="NfModel.html#4326" class="Bound">t</a><a id="4327" class="Symbol">)</a>  <a id="4330" class="Symbol">=</a> <a id="4332" href="NfModel.html#520" class="InductiveConstructor">falseC</a> <a id="4339" class="Symbol">(</a><a id="4340" href="Derivations.html#4297" class="Function">monNe</a> <a id="4346" href="NfModel.html#4316" class="Bound">τ</a> <a id="4348" href="NfModel.html#4326" class="Bound">t</a><a id="4349" class="Symbol">)</a>
<a id="4351" href="NfModel.html#4268" class="Function">monC</a> <a id="4356" href="NfModel.html#4356" class="Bound">τ</a> <a id="4358" class="Symbol">(</a><a id="4359" href="NfModel.html#558" class="InductiveConstructor">orC</a> <a id="4363" href="NfModel.html#4363" class="Bound">t</a> <a id="4365" href="NfModel.html#4365" class="Bound">c</a> <a id="4367" href="NfModel.html#4367" class="Bound">d</a><a id="4368" class="Symbol">)</a> <a id="4370" class="Symbol">=</a> <a id="4372" href="NfModel.html#558" class="InductiveConstructor">orC</a> <a id="4376" class="Symbol">(</a><a id="4377" href="Derivations.html#4297" class="Function">monNe</a> <a id="4383" href="NfModel.html#4356" class="Bound">τ</a> <a id="4385" href="NfModel.html#4363" class="Bound">t</a><a id="4386" class="Symbol">)</a> <a id="4388" class="Symbol">(</a><a id="4389" href="NfModel.html#4268" class="Function">monC</a> <a id="4394" class="Symbol">(</a><a id="4395" href="Formulas.html#622" class="InductiveConstructor">lift</a> <a id="4400" href="NfModel.html#4356" class="Bound">τ</a><a id="4401" class="Symbol">)</a> <a id="4403" href="NfModel.html#4365" class="Bound">c</a><a id="4404" class="Symbol">)</a> <a id="4406" class="Symbol">(</a><a id="4407" href="NfModel.html#4268" class="Function">monC</a> <a id="4412" class="Symbol">(</a><a id="4413" href="Formulas.html#622" class="InductiveConstructor">lift</a> <a id="4418" href="NfModel.html#4356" class="Bound">τ</a><a id="4419" class="Symbol">)</a> <a id="4421" href="NfModel.html#4367" class="Bound">d</a><a id="4422" class="Symbol">)</a>

<a id="4425" class="Comment">-- Undoing a weakening on a path.</a>
<a id="4459" class="Comment">--</a>
<a id="4462" class="Comment">-- If we have a path  e : Φ ∈ monC τ c  in a case tree  c : Cover Γ  transported</a>
<a id="4543" class="Comment">-- to Δ via thinning  τ : Δ ≤ Γ, we also get a path  e&#39; : Ψ ∈ c  in the original</a>
<a id="4624" class="Comment">-- case tree c such that Ψ is a strenthening of Φ  (Φ ≤ Ψ).</a>

<a id="mon∈"></a><a id="4685" href="NfModel.html#4685" class="Function">mon∈</a> <a id="4690" class="Symbol">:</a> <a id="4692" class="Symbol">∀{</a><a id="4694" href="NfModel.html#4694" class="Bound">Γ</a> <a id="4696" href="NfModel.html#4696" class="Bound">Δ</a> <a id="4698" href="NfModel.html#4698" class="Bound">Φ</a><a id="4699" class="Symbol">}</a> <a id="4701" class="Symbol">(</a><a id="4702" href="NfModel.html#4702" class="Bound">c</a> <a id="4704" class="Symbol">:</a> <a id="4706" href="NfModel.html#471" class="Datatype">Cover</a> <a id="4712" href="NfModel.html#4694" class="Bound">Γ</a><a id="4713" class="Symbol">)</a> <a id="4715" class="Symbol">(</a><a id="4716" href="NfModel.html#4716" class="Bound">τ</a> <a id="4718" class="Symbol">:</a> <a id="4720" href="NfModel.html#4696" class="Bound">Δ</a> <a id="4722" href="Formulas.html#533" class="Datatype Operator">≤</a> <a id="4724" href="NfModel.html#4694" class="Bound">Γ</a><a id="4725" class="Symbol">)</a> <a id="4727" class="Symbol">(</a><a id="4728" href="NfModel.html#4728" class="Bound">e</a> <a id="4730" class="Symbol">:</a> <a id="4732" href="NfModel.html#4698" class="Bound">Φ</a> <a id="4734" href="NfModel.html#940" class="Datatype Operator">∈</a> <a id="4736" href="NfModel.html#4268" class="Function">monC</a> <a id="4741" href="NfModel.html#4716" class="Bound">τ</a> <a id="4743" href="NfModel.html#4702" class="Bound">c</a><a id="4744" class="Symbol">)</a> <a id="4746" class="Symbol">→</a> <a id="4748" href="Data.Product.html#1369" class="Function">∃</a> <a id="4750" class="Symbol">λ</a> <a id="4752" href="NfModel.html#4752" class="Bound">Ψ</a> <a id="4754" class="Symbol">→</a> <a id="4756" href="NfModel.html#4752" class="Bound">Ψ</a> <a id="4758" href="NfModel.html#940" class="Datatype Operator">∈</a> <a id="4760" href="NfModel.html#4702" class="Bound">c</a> <a id="4762" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="4764" href="NfModel.html#4698" class="Bound">Φ</a> <a id="4766" href="Formulas.html#533" class="Datatype Operator">≤</a> <a id="4768" href="NfModel.html#4752" class="Bound">Ψ</a>
<a id="4770" href="NfModel.html#4685" class="Function">mon∈</a>  <a id="4776" href="NfModel.html#501" class="InductiveConstructor">hole</a> <a id="4781" href="NfModel.html#4781" class="Bound">τ</a> <a id="4783" href="NfModel.html#988" class="InductiveConstructor">here</a> <a id="4788" class="Symbol">=</a> <a id="4790" class="Symbol">_</a> <a id="4792" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="4794" href="NfModel.html#988" class="InductiveConstructor">here</a> <a id="4799" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="4801" href="NfModel.html#4781" class="Bound">τ</a>
<a id="4803" href="NfModel.html#4685" class="Function">mon∈</a> <a id="4808" class="Symbol">(</a><a id="4809" href="NfModel.html#520" class="InductiveConstructor">falseC</a> <a id="4816" href="NfModel.html#4816" class="Bound">t</a><a id="4817" class="Symbol">)</a>  <a id="4820" href="NfModel.html#4820" class="Bound">τ</a> <a id="4822" class="Symbol">()</a>
<a id="4825" href="NfModel.html#4685" class="Function">mon∈</a> <a id="4830" class="Symbol">(</a><a id="4831" href="NfModel.html#558" class="InductiveConstructor">orC</a> <a id="4835" href="NfModel.html#4835" class="Bound">t</a> <a id="4837" href="NfModel.html#4837" class="Bound">c</a> <a id="4839" href="NfModel.html#4839" class="Bound">d</a><a id="4840" class="Symbol">)</a> <a id="4842" href="NfModel.html#4842" class="Bound">τ</a> <a id="4844" class="Symbol">(</a><a id="4845" href="NfModel.html#1011" class="InductiveConstructor">left</a> <a id="4850" href="NfModel.html#4850" class="Bound">e</a><a id="4851" class="Symbol">)</a>  <a id="4854" class="Keyword">with</a> <a id="4859" href="NfModel.html#4685" class="Function">mon∈</a> <a id="4864" href="NfModel.html#4837" class="Bound">c</a> <a id="4866" class="Symbol">(</a><a id="4867" href="Formulas.html#622" class="InductiveConstructor">lift</a> <a id="4872" href="NfModel.html#4842" class="Bound">τ</a><a id="4873" class="Symbol">)</a> <a id="4875" href="NfModel.html#4850" class="Bound">e</a>
<a id="4877" class="Symbol">...</a> <a id="4881" class="Symbol">|</a> <a id="4883" href="NfModel.html#4883" class="Bound">Ψ</a> <a id="4885" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="4887" href="NfModel.html#4887" class="Bound">e&#39;</a> <a id="4890" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="4892" href="NfModel.html#4892" class="Bound">σ</a> <a id="4894" class="Symbol">=</a> <a id="4896" href="NfModel.html#4883" class="Bound">Ψ</a> <a id="4898" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="4900" href="NfModel.html#1011" class="InductiveConstructor">left</a> <a id="4905" href="NfModel.html#4887" class="Bound">e&#39;</a> <a id="4908" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="4910" href="NfModel.html#4892" class="Bound">σ</a>
<a id="4912" href="NfModel.html#4685" class="Function">mon∈</a> <a id="4917" class="Symbol">(</a><a id="4918" href="NfModel.html#558" class="InductiveConstructor">orC</a> <a id="4922" href="NfModel.html#4922" class="Bound">t</a> <a id="4924" href="NfModel.html#4924" class="Bound">c</a> <a id="4926" href="NfModel.html#4926" class="Bound">d</a><a id="4927" class="Symbol">)</a> <a id="4929" href="NfModel.html#4929" class="Bound">τ</a> <a id="4931" class="Symbol">(</a><a id="4932" href="NfModel.html#1081" class="InductiveConstructor">right</a> <a id="4938" href="NfModel.html#4938" class="Bound">e</a><a id="4939" class="Symbol">)</a> <a id="4941" class="Keyword">with</a> <a id="4946" href="NfModel.html#4685" class="Function">mon∈</a> <a id="4951" href="NfModel.html#4926" class="Bound">d</a> <a id="4953" class="Symbol">(</a><a id="4954" href="Formulas.html#622" class="InductiveConstructor">lift</a> <a id="4959" href="NfModel.html#4929" class="Bound">τ</a><a id="4960" class="Symbol">)</a> <a id="4962" href="NfModel.html#4938" class="Bound">e</a>
<a id="4964" class="Symbol">...</a> <a id="4968" class="Symbol">|</a> <a id="4970" href="NfModel.html#4970" class="Bound">Ψ</a> <a id="4972" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="4974" href="NfModel.html#4974" class="Bound">e&#39;</a> <a id="4977" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="4979" href="NfModel.html#4979" class="Bound">σ</a> <a id="4981" class="Symbol">=</a> <a id="4983" href="NfModel.html#4970" class="Bound">Ψ</a> <a id="4985" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="4987" href="NfModel.html#1081" class="InductiveConstructor">right</a> <a id="4993" href="NfModel.html#4974" class="Bound">e&#39;</a> <a id="4996" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="4998" href="NfModel.html#4979" class="Bound">σ</a>

<a id="5001" class="Comment">-- Packaging a case tree with its valuation.</a>

<a id="CovExt"></a><a id="5047" href="NfModel.html#5047" class="Function">CovExt</a> <a id="5054" class="Symbol">:</a> <a id="5056" class="Symbol">(</a><a id="5057" href="NfModel.html#5057" class="Bound">Γ</a> <a id="5059" class="Symbol">:</a> <a id="5061" href="Formulas.html#406" class="Datatype">Cxt</a><a id="5064" class="Symbol">)</a> <a id="5066" class="Symbol">(</a><a id="5067" href="NfModel.html#5067" class="Bound">P</a> <a id="5069" class="Symbol">:</a> <a id="5071" href="Formulas.html#406" class="Datatype">Cxt</a> <a id="5075" class="Symbol">→</a> <a id="5077" class="PrimitiveType">Set</a><a id="5080" class="Symbol">)</a> <a id="5082" class="Symbol">→</a> <a id="5084" class="PrimitiveType">Set</a>
<a id="5088" href="NfModel.html#5047" class="Function">CovExt</a> <a id="5095" href="NfModel.html#5095" class="Bound">Γ</a> <a id="5097" href="NfModel.html#5097" class="Bound">P</a> <a id="5099" class="Symbol">=</a> <a id="5101" href="Agda.Builtin.Sigma.html#139" class="Record">Σ</a> <a id="5103" class="Symbol">(</a><a id="5104" href="NfModel.html#471" class="Datatype">Cover</a> <a id="5110" href="NfModel.html#5095" class="Bound">Γ</a><a id="5111" class="Symbol">)</a> <a id="5113" class="Symbol">λ</a> <a id="5115" href="NfModel.html#5115" class="Bound">c</a> <a id="5117" class="Symbol">→</a> <a id="5119" href="NfModel.html#1316" class="Function">All</a> <a id="5123" href="NfModel.html#5115" class="Bound">c</a> <a id="5125" href="NfModel.html#5097" class="Bound">P</a>

<a id="transCE"></a><a id="5128" href="NfModel.html#5128" class="Function">transCE</a> <a id="5136" class="Symbol">:</a> <a id="5138" class="Symbol">∀</a> <a id="5140" class="Symbol">{</a><a id="5141" href="NfModel.html#5141" class="Bound">P</a> <a id="5143" href="NfModel.html#5143" class="Bound">Γ</a><a id="5144" class="Symbol">}</a> <a id="5146" class="Symbol">(</a><a id="5147" href="NfModel.html#5147" class="Bound">c</a> <a id="5149" class="Symbol">:</a> <a id="5151" href="NfModel.html#471" class="Datatype">Cover</a> <a id="5157" href="NfModel.html#5143" class="Bound">Γ</a><a id="5158" class="Symbol">)</a> <a id="5160" class="Symbol">(</a><a id="5161" href="NfModel.html#5161" class="Bound">f</a> <a id="5163" class="Symbol">:</a> <a id="5165" href="NfModel.html#1316" class="Function">All</a> <a id="5169" href="NfModel.html#5147" class="Bound">c</a> <a id="5171" class="Symbol">λ</a> <a id="5173" href="NfModel.html#5173" class="Bound">Δ</a> <a id="5175" class="Symbol">→</a> <a id="5177" href="NfModel.html#5047" class="Function">CovExt</a> <a id="5184" href="NfModel.html#5173" class="Bound">Δ</a> <a id="5186" href="NfModel.html#5141" class="Bound">P</a><a id="5187" class="Symbol">)</a> <a id="5189" class="Symbol">→</a> <a id="5191" href="NfModel.html#5047" class="Function">CovExt</a> <a id="5198" href="NfModel.html#5143" class="Bound">Γ</a> <a id="5200" href="NfModel.html#5141" class="Bound">P</a>
<a id="5202" href="NfModel.html#5128" class="Function">transCE</a> <a id="5210" href="NfModel.html#5210" class="Bound">c</a> <a id="5212" href="NfModel.html#5212" class="Bound">f</a> <a id="5214" class="Symbol">=</a> <a id="5216" href="NfModel.html#2298" class="Function">transC</a> <a id="5223" href="NfModel.html#5210" class="Bound">c</a> <a id="5225" class="Symbol">(</a><a id="5226" href="Agda.Builtin.Sigma.html#225" class="Field">proj₁</a> <a id="5232" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="5234" href="NfModel.html#5212" class="Bound">f</a><a id="5235" class="Symbol">)</a> <a id="5237" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="5239" class="Symbol">λ</a> <a id="5241" href="NfModel.html#5241" class="Bound">e</a> <a id="5243" class="Symbol">→</a>
  <a id="5247" class="Keyword">let</a> <a id="5251" class="Symbol">_</a> <a id="5253" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="5255" href="NfModel.html#5255" class="Bound">e₁</a> <a id="5258" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="5260" href="NfModel.html#5260" class="Bound">e₂</a> <a id="5263" class="Symbol">=</a> <a id="5265" href="NfModel.html#3345" class="Function">split∈</a> <a id="5272" href="NfModel.html#5210" class="Bound">c</a> <a id="5274" class="Symbol">(</a><a id="5275" href="Agda.Builtin.Sigma.html#225" class="Field">proj₁</a> <a id="5281" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="5283" href="NfModel.html#5212" class="Bound">f</a><a id="5284" class="Symbol">)</a> <a id="5286" href="NfModel.html#5241" class="Bound">e</a>
  <a id="5290" class="Keyword">in</a>  <a id="5294" href="NfModel.html#5212" class="Bound">f</a> <a id="5296" href="NfModel.html#5255" class="Bound">e₁</a> <a id="5299" class="Symbol">.</a><a id="5300" href="Agda.Builtin.Sigma.html#237" class="Field">proj₂</a> <a id="5306" href="NfModel.html#5260" class="Bound">e₂</a>

<a id="monCE"></a><a id="5310" href="NfModel.html#5310" class="Function">monCE</a> <a id="5316" class="Symbol">:</a> <a id="5318" class="Symbol">∀{</a><a id="5320" href="NfModel.html#5320" class="Bound">P</a><a id="5321" class="Symbol">}</a> <a id="5323" class="Symbol">→</a> <a id="5325" href="Formulas.html#3040" class="Function">Mon</a> <a id="5329" href="NfModel.html#5320" class="Bound">P</a> <a id="5331" class="Symbol">→</a> <a id="5333" href="Formulas.html#3040" class="Function">Mon</a> <a id="5337" class="Symbol">λ</a> <a id="5339" href="NfModel.html#5339" class="Bound">Γ</a> <a id="5341" class="Symbol">→</a> <a id="5343" href="NfModel.html#5047" class="Function">CovExt</a> <a id="5350" href="NfModel.html#5339" class="Bound">Γ</a> <a id="5352" href="NfModel.html#5320" class="Bound">P</a>
<a id="5354" href="NfModel.html#5310" class="Function">monCE</a> <a id="5360" href="NfModel.html#5360" class="Bound">monP</a> <a id="5365" href="NfModel.html#5365" class="Bound">τ</a> <a id="5367" class="Symbol">(</a><a id="5368" href="NfModel.html#5368" class="Bound">c</a> <a id="5370" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="5372" href="NfModel.html#5372" class="Bound">f</a><a id="5373" class="Symbol">)</a> <a id="5375" class="Symbol">=</a> <a id="5377" href="NfModel.html#4268" class="Function">monC</a> <a id="5382" href="NfModel.html#5365" class="Bound">τ</a> <a id="5384" href="NfModel.html#5368" class="Bound">c</a> <a id="5386" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a>  <a id="5389" class="Symbol">λ</a> <a id="5391" class="Symbol">{</a><a id="5392" href="NfModel.html#5392" class="Bound">Φ</a><a id="5393" class="Symbol">}</a> <a id="5395" href="NfModel.html#5395" class="Bound">e</a> <a id="5397" class="Symbol">→</a>
  <a id="5401" class="Keyword">let</a> <a id="5405" href="NfModel.html#5405" class="Bound">Ψ</a> <a id="5407" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="5409" href="NfModel.html#5409" class="Bound">e&#39;</a> <a id="5412" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="5414" href="NfModel.html#5414" class="Bound">σ</a> <a id="5416" class="Symbol">=</a> <a id="5418" href="NfModel.html#4685" class="Function">mon∈</a> <a id="5423" href="NfModel.html#5368" class="Bound">c</a> <a id="5425" href="NfModel.html#5365" class="Bound">τ</a> <a id="5427" href="NfModel.html#5395" class="Bound">e</a>
  <a id="5431" class="Keyword">in</a>  <a id="5435" href="NfModel.html#5360" class="Bound">monP</a> <a id="5440" href="NfModel.html#5414" class="Bound">σ</a> <a id="5442" class="Symbol">(</a><a id="5443" href="NfModel.html#5372" class="Bound">f</a> <a id="5445" class="Symbol">{</a><a id="5446" href="NfModel.html#5405" class="Bound">Ψ</a><a id="5447" class="Symbol">}</a> <a id="5449" href="NfModel.html#5409" class="Bound">e&#39;</a><a id="5451" class="Symbol">)</a>

<a id="5454" class="Comment">-- The syntactic Beth model.</a>

<a id="5484" class="Comment">-- We interpret base propositions  Atom P  by their normal deriviations.</a>
<a id="5557" class="Comment">-- (&quot;Normal&quot; is important; &quot;neutral is not sufficient since we need case trees here.)</a>

<a id="5644" class="Comment">-- The negative connectives True, ∧, and ⇒ are explained as usual by η-expansion</a>
<a id="5725" class="Comment">-- and the meta-level connective.</a>

<a id="5760" class="Comment">-- The positive connectives False and ∨ are inhabited by case trees.</a>
<a id="5829" class="Comment">-- In case False, the tree has no leaves.</a>
<a id="5871" class="Comment">-- In case A ∨ B, each leaf must be in the semantics of either A or B.</a>

<a id="T⟦_⟧"></a><a id="5943" href="NfModel.html#5943" class="Function Operator">T⟦_⟧</a> <a id="5948" class="Symbol">:</a> <a id="5950" class="Symbol">(</a><a id="5951" href="NfModel.html#5951" class="Bound">A</a> <a id="5953" class="Symbol">:</a> <a id="5955" href="Formulas.html#195" class="Datatype">Form</a><a id="5959" class="Symbol">)</a> <a id="5961" class="Symbol">(</a><a id="5962" href="NfModel.html#5962" class="Bound">Γ</a> <a id="5964" class="Symbol">:</a> <a id="5966" href="Formulas.html#406" class="Datatype">Cxt</a><a id="5969" class="Symbol">)</a> <a id="5971" class="Symbol">→</a> <a id="5973" class="PrimitiveType">Set</a>
<a id="5977" href="NfModel.html#5943" class="Function Operator">T⟦</a> <a id="5980" href="Formulas.html#214" class="InductiveConstructor">Atom</a> <a id="5985" href="NfModel.html#5985" class="Bound">P</a> <a id="5987" href="NfModel.html#5943" class="Function Operator">⟧</a> <a id="5989" href="NfModel.html#5989" class="Bound">Γ</a> <a id="5991" class="Symbol">=</a> <a id="5993" href="Derivations.html#3373" class="Datatype">Nf</a> <a id="5996" href="NfModel.html#5989" class="Bound">Γ</a> <a id="5998" class="Symbol">(</a><a id="5999" href="Formulas.html#214" class="InductiveConstructor">Atom</a> <a id="6004" href="NfModel.html#5985" class="Bound">P</a><a id="6005" class="Symbol">)</a>
<a id="6007" href="NfModel.html#5943" class="Function Operator">T⟦</a> <a id="6010" href="Formulas.html#241" class="InductiveConstructor">True</a>   <a id="6017" href="NfModel.html#5943" class="Function Operator">⟧</a> <a id="6019" href="NfModel.html#6019" class="Bound">Γ</a> <a id="6021" class="Symbol">=</a> <a id="6023" href="Agda.Builtin.Unit.html#137" class="Record">⊤</a>
<a id="6025" href="NfModel.html#5943" class="Function Operator">T⟦</a> <a id="6028" href="Formulas.html#246" class="InductiveConstructor">False</a>  <a id="6035" href="NfModel.html#5943" class="Function Operator">⟧</a> <a id="6037" href="NfModel.html#6037" class="Bound">Γ</a> <a id="6039" class="Symbol">=</a> <a id="6041" href="NfModel.html#5047" class="Function">CovExt</a> <a id="6048" href="NfModel.html#6037" class="Bound">Γ</a> <a id="6050" class="Symbol">λ</a> <a id="6052" href="NfModel.html#6052" class="Bound">Δ</a> <a id="6054" class="Symbol">→</a> <a id="6056" href="Data.Empty.html#260" class="Datatype">⊥</a>
<a id="6058" href="NfModel.html#5943" class="Function Operator">T⟦</a> <a id="6061" href="NfModel.html#6061" class="Bound">A</a> <a id="6063" href="Formulas.html#261" class="InductiveConstructor Operator">∨</a> <a id="6065" href="NfModel.html#6065" class="Bound">B</a>  <a id="6068" href="NfModel.html#5943" class="Function Operator">⟧</a> <a id="6070" href="NfModel.html#6070" class="Bound">Γ</a> <a id="6072" class="Symbol">=</a> <a id="6074" href="NfModel.html#5047" class="Function">CovExt</a> <a id="6081" href="NfModel.html#6070" class="Bound">Γ</a> <a id="6083" class="Symbol">λ</a> <a id="6085" href="NfModel.html#6085" class="Bound">Δ</a> <a id="6087" class="Symbol">→</a> <a id="6089" href="NfModel.html#5943" class="Function Operator">T⟦</a> <a id="6092" href="NfModel.html#6061" class="Bound">A</a> <a id="6094" href="NfModel.html#5943" class="Function Operator">⟧</a> <a id="6096" href="NfModel.html#6085" class="Bound">Δ</a> <a id="6098" href="Data.Sum.Base.html#617" class="Datatype Operator">⊎</a> <a id="6100" href="NfModel.html#5943" class="Function Operator">T⟦</a> <a id="6103" href="NfModel.html#6065" class="Bound">B</a> <a id="6105" href="NfModel.html#5943" class="Function Operator">⟧</a> <a id="6107" href="NfModel.html#6085" class="Bound">Δ</a>
<a id="6109" href="NfModel.html#5943" class="Function Operator">T⟦</a> <a id="6112" href="NfModel.html#6112" class="Bound">A</a> <a id="6114" href="Formulas.html#265" class="InductiveConstructor Operator">∧</a> <a id="6116" href="NfModel.html#6116" class="Bound">B</a>  <a id="6119" href="NfModel.html#5943" class="Function Operator">⟧</a> <a id="6121" href="NfModel.html#6121" class="Bound">Γ</a> <a id="6123" class="Symbol">=</a> <a id="6125" href="NfModel.html#5943" class="Function Operator">T⟦</a> <a id="6128" href="NfModel.html#6112" class="Bound">A</a> <a id="6130" href="NfModel.html#5943" class="Function Operator">⟧</a> <a id="6132" href="NfModel.html#6121" class="Bound">Γ</a> <a id="6134" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="6136" href="NfModel.html#5943" class="Function Operator">T⟦</a> <a id="6139" href="NfModel.html#6116" class="Bound">B</a> <a id="6141" href="NfModel.html#5943" class="Function Operator">⟧</a> <a id="6143" href="NfModel.html#6121" class="Bound">Γ</a>
<a id="6145" href="NfModel.html#5943" class="Function Operator">T⟦</a> <a id="6148" href="NfModel.html#6148" class="Bound">A</a> <a id="6150" href="Formulas.html#269" class="InductiveConstructor Operator">⇒</a> <a id="6152" href="NfModel.html#6152" class="Bound">B</a>  <a id="6155" href="NfModel.html#5943" class="Function Operator">⟧</a> <a id="6157" href="NfModel.html#6157" class="Bound">Γ</a> <a id="6159" class="Symbol">=</a> <a id="6161" class="Symbol">∀{</a><a id="6163" href="NfModel.html#6163" class="Bound">Δ</a><a id="6164" class="Symbol">}</a> <a id="6166" class="Symbol">(</a><a id="6167" href="NfModel.html#6167" class="Bound">τ</a> <a id="6169" class="Symbol">:</a> <a id="6171" href="NfModel.html#6163" class="Bound">Δ</a> <a id="6173" href="Formulas.html#533" class="Datatype Operator">≤</a> <a id="6175" href="NfModel.html#6157" class="Bound">Γ</a><a id="6176" class="Symbol">)</a> <a id="6178" class="Symbol">→</a> <a id="6180" href="NfModel.html#5943" class="Function Operator">T⟦</a> <a id="6183" href="NfModel.html#6148" class="Bound">A</a> <a id="6185" href="NfModel.html#5943" class="Function Operator">⟧</a> <a id="6187" href="NfModel.html#6163" class="Bound">Δ</a> <a id="6189" class="Symbol">→</a> <a id="6191" href="NfModel.html#5943" class="Function Operator">T⟦</a> <a id="6194" href="NfModel.html#6152" class="Bound">B</a> <a id="6196" href="NfModel.html#5943" class="Function Operator">⟧</a> <a id="6198" href="NfModel.html#6163" class="Bound">Δ</a>

<a id="6201" class="Comment">-- Monotonicity of the model is proven by induction on the proposition,</a>
<a id="6273" class="Comment">-- using monotonicity of covers and the built-in monotonicity at implication.</a>

<a id="6352" class="Comment">-- monT : ∀ A {Γ Δ} (τ : Δ ≤ Γ) → T⟦ A ⟧ Γ → T⟦ A ⟧ Δ</a>

<a id="monT"></a><a id="6407" href="NfModel.html#6407" class="Function">monT</a> <a id="6412" class="Symbol">:</a> <a id="6414" class="Symbol">∀</a> <a id="6416" href="NfModel.html#6416" class="Bound">A</a> <a id="6418" class="Symbol">→</a> <a id="6420" href="Formulas.html#3040" class="Function">Mon</a> <a id="6424" href="NfModel.html#5943" class="Function Operator">T⟦</a> <a id="6427" href="NfModel.html#6416" class="Bound">A</a> <a id="6429" href="NfModel.html#5943" class="Function Operator">⟧</a>
<a id="6431" href="NfModel.html#6407" class="Function">monT</a> <a id="6436" class="Symbol">(</a><a id="6437" href="Formulas.html#214" class="InductiveConstructor">Atom</a> <a id="6442" href="NfModel.html#6442" class="Bound">P</a><a id="6443" class="Symbol">)</a> <a id="6445" class="Symbol">=</a> <a id="6447" href="Derivations.html#4503" class="Function">monNf</a>
<a id="6453" href="NfModel.html#6407" class="Function">monT</a> <a id="6458" href="Formulas.html#241" class="InductiveConstructor">True</a>     <a id="6467" class="Symbol">=</a> <a id="6469" class="Symbol">_</a>
<a id="6471" href="NfModel.html#6407" class="Function">monT</a> <a id="6476" href="Formulas.html#246" class="InductiveConstructor">False</a>    <a id="6485" class="Symbol">=</a> <a id="6487" href="NfModel.html#5310" class="Function">monCE</a> <a id="6493" class="Symbol">λ</a> <a id="6495" href="NfModel.html#6495" class="Bound">τ</a> <a id="6497" class="Symbol">()</a>
<a id="6500" href="NfModel.html#6407" class="Function">monT</a> <a id="6505" class="Symbol">(</a><a id="6506" href="NfModel.html#6506" class="Bound">A</a> <a id="6508" href="Formulas.html#261" class="InductiveConstructor Operator">∨</a> <a id="6510" href="NfModel.html#6510" class="Bound">B</a><a id="6511" class="Symbol">)</a>  <a id="6514" class="Symbol">=</a> <a id="6516" href="NfModel.html#5310" class="Function">monCE</a> <a id="6522" class="Symbol">λ</a> <a id="6524" href="NfModel.html#6524" class="Bound">τ</a> <a id="6526" class="Symbol">→</a> <a id="6528" href="Data.Sum.Base.html#1203" class="Function">map-⊎</a> <a id="6534" class="Symbol">(</a><a id="6535" href="NfModel.html#6407" class="Function">monT</a> <a id="6540" href="NfModel.html#6506" class="Bound">A</a> <a id="6542" href="NfModel.html#6524" class="Bound">τ</a><a id="6543" class="Symbol">)</a> <a id="6545" class="Symbol">(</a><a id="6546" href="NfModel.html#6407" class="Function">monT</a> <a id="6551" href="NfModel.html#6510" class="Bound">B</a> <a id="6553" href="NfModel.html#6524" class="Bound">τ</a><a id="6554" class="Symbol">)</a>
<a id="6556" href="NfModel.html#6407" class="Function">monT</a> <a id="6561" class="Symbol">(</a><a id="6562" href="NfModel.html#6562" class="Bound">A</a> <a id="6564" href="Formulas.html#265" class="InductiveConstructor Operator">∧</a> <a id="6566" href="NfModel.html#6566" class="Bound">B</a><a id="6567" class="Symbol">)</a> <a id="6569" href="NfModel.html#6569" class="Bound">τ</a> <a id="6571" class="Symbol">(</a><a id="6572" href="NfModel.html#6572" class="Bound">a</a> <a id="6574" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="6576" href="NfModel.html#6576" class="Bound">b</a><a id="6577" class="Symbol">)</a> <a id="6579" class="Symbol">=</a> <a id="6581" href="NfModel.html#6407" class="Function">monT</a> <a id="6586" href="NfModel.html#6562" class="Bound">A</a> <a id="6588" href="NfModel.html#6569" class="Bound">τ</a> <a id="6590" href="NfModel.html#6572" class="Bound">a</a> <a id="6592" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="6594" href="NfModel.html#6407" class="Function">monT</a> <a id="6599" href="NfModel.html#6566" class="Bound">B</a> <a id="6601" href="NfModel.html#6569" class="Bound">τ</a> <a id="6603" href="NfModel.html#6576" class="Bound">b</a>
<a id="6605" href="NfModel.html#6407" class="Function">monT</a> <a id="6610" class="Symbol">(</a><a id="6611" href="NfModel.html#6611" class="Bound">A</a> <a id="6613" href="Formulas.html#269" class="InductiveConstructor Operator">⇒</a> <a id="6615" href="NfModel.html#6615" class="Bound">B</a><a id="6616" class="Symbol">)</a> <a id="6618" href="NfModel.html#6618" class="Bound">τ</a> <a id="6620" href="NfModel.html#6620" class="Bound">f</a> <a id="6622" href="NfModel.html#6622" class="Bound">σ</a> <a id="6624" class="Symbol">=</a> <a id="6626" href="NfModel.html#6620" class="Bound">f</a> <a id="6628" class="Symbol">(</a><a id="6629" href="NfModel.html#6622" class="Bound">σ</a> <a id="6631" href="Formulas.html#752" class="Function Operator">•</a> <a id="6633" href="NfModel.html#6618" class="Bound">τ</a><a id="6634" class="Symbol">)</a>

<a id="6637" class="Comment">-- Reflection / reification, proven simultaneously by induction on the proposition.</a>

<a id="6722" class="Comment">-- Reflection is η-expansion (and recursively reflection);</a>
<a id="6781" class="Comment">-- at positive connections we build a case tree with a single scrutinee: the neutral</a>
<a id="6866" class="Comment">-- we are reflecting.</a>

<a id="6889" class="Comment">-- At implication, we need reification, which produces introductions</a>
<a id="6958" class="Comment">-- and reifies the stored case trees.</a>

<a id="6997" class="Keyword">mutual</a>

  <a id="reflect"></a><a id="7007" href="NfModel.html#7007" class="Function">reflect</a> <a id="7015" class="Symbol">:</a> <a id="7017" class="Symbol">∀{</a><a id="7019" href="NfModel.html#7019" class="Bound">Γ</a><a id="7020" class="Symbol">}</a> <a id="7022" href="NfModel.html#7022" class="Bound">A</a> <a id="7024" class="Symbol">(</a><a id="7025" href="NfModel.html#7025" class="Bound">t</a> <a id="7027" class="Symbol">:</a> <a id="7029" href="Derivations.html#3137" class="Datatype">Ne</a> <a id="7032" href="NfModel.html#7019" class="Bound">Γ</a> <a id="7034" href="NfModel.html#7022" class="Bound">A</a><a id="7035" class="Symbol">)</a> <a id="7037" class="Symbol">→</a> <a id="7039" href="NfModel.html#5943" class="Function Operator">T⟦</a> <a id="7042" href="NfModel.html#7022" class="Bound">A</a> <a id="7044" href="NfModel.html#5943" class="Function Operator">⟧</a> <a id="7046" href="NfModel.html#7019" class="Bound">Γ</a>
  <a id="7050" href="NfModel.html#7007" class="Function">reflect</a> <a id="7058" class="Symbol">(</a><a id="7059" href="Formulas.html#214" class="InductiveConstructor">Atom</a> <a id="7064" href="NfModel.html#7064" class="Bound">P</a><a id="7065" class="Symbol">)</a> <a id="7067" href="NfModel.html#7067" class="Bound">t</a> <a id="7069" class="Symbol">=</a> <a id="7071" href="Derivations.html#3482" class="InductiveConstructor">ne</a> <a id="7074" href="NfModel.html#7067" class="Bound">t</a>
  <a id="7078" href="NfModel.html#7007" class="Function">reflect</a> <a id="7086" href="Formulas.html#241" class="InductiveConstructor">True</a>     <a id="7095" href="NfModel.html#7095" class="Bound">t</a> <a id="7097" class="Symbol">=</a> <a id="7099" class="Symbol">_</a>
  <a id="7103" href="NfModel.html#7007" class="Function">reflect</a> <a id="7111" href="Formulas.html#246" class="InductiveConstructor">False</a>    <a id="7120" href="NfModel.html#7120" class="Bound">t</a> <a id="7122" class="Symbol">=</a> <a id="7124" href="NfModel.html#520" class="InductiveConstructor">falseC</a> <a id="7131" href="NfModel.html#7120" class="Bound">t</a> <a id="7133" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="7135" class="Symbol">λ()</a>
  <a id="7141" href="NfModel.html#7007" class="Function">reflect</a> <a id="7149" class="Symbol">(</a><a id="7150" href="NfModel.html#7150" class="Bound">A</a> <a id="7152" href="Formulas.html#261" class="InductiveConstructor Operator">∨</a> <a id="7154" href="NfModel.html#7154" class="Bound">B</a><a id="7155" class="Symbol">)</a>  <a id="7158" href="NfModel.html#7158" class="Bound">t</a> <a id="7160" class="Symbol">=</a> <a id="7162" href="NfModel.html#558" class="InductiveConstructor">orC</a> <a id="7166" href="NfModel.html#7158" class="Bound">t</a> <a id="7168" href="NfModel.html#501" class="InductiveConstructor">hole</a> <a id="7173" href="NfModel.html#501" class="InductiveConstructor">hole</a> <a id="7178" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="7180" class="Symbol">λ</a> <a id="7182" class="Keyword">where</a>
    <a id="7192" class="Symbol">(</a><a id="7193" href="NfModel.html#1011" class="InductiveConstructor">left</a>  <a id="7199" href="NfModel.html#988" class="InductiveConstructor">here</a><a id="7203" class="Symbol">)</a> <a id="7205" class="Symbol">→</a> <a id="7207" href="Data.Sum.Base.html#667" class="InductiveConstructor">inj₁</a> <a id="7212" class="Symbol">(</a><a id="7213" href="NfModel.html#7007" class="Function">reflect</a> <a id="7221" href="NfModel.html#7150" class="Bound">A</a> <a id="7223" class="Symbol">(</a><a id="7224" href="Derivations.html#3177" class="InductiveConstructor">hyp</a> <a id="7228" href="Formulas.html#2967" class="InductiveConstructor">top</a><a id="7231" class="Symbol">))</a>
    <a id="7238" class="Symbol">(</a><a id="7239" href="NfModel.html#1081" class="InductiveConstructor">right</a> <a id="7245" href="NfModel.html#988" class="InductiveConstructor">here</a><a id="7249" class="Symbol">)</a> <a id="7251" class="Symbol">→</a> <a id="7253" href="Data.Sum.Base.html#692" class="InductiveConstructor">inj₂</a> <a id="7258" class="Symbol">(</a><a id="7259" href="NfModel.html#7007" class="Function">reflect</a> <a id="7267" href="NfModel.html#7154" class="Bound">B</a> <a id="7269" class="Symbol">(</a><a id="7270" href="Derivations.html#3177" class="InductiveConstructor">hyp</a> <a id="7274" href="Formulas.html#2967" class="InductiveConstructor">top</a><a id="7277" class="Symbol">))</a>
  <a id="7282" href="NfModel.html#7007" class="Function">reflect</a> <a id="7290" class="Symbol">(</a><a id="7291" href="NfModel.html#7291" class="Bound">A</a> <a id="7293" href="Formulas.html#265" class="InductiveConstructor Operator">∧</a> <a id="7295" href="NfModel.html#7295" class="Bound">B</a><a id="7296" class="Symbol">)</a>  <a id="7299" href="NfModel.html#7299" class="Bound">t</a> <a id="7301" class="Symbol">=</a> <a id="7303" href="NfModel.html#7007" class="Function">reflect</a> <a id="7311" href="NfModel.html#7291" class="Bound">A</a> <a id="7313" class="Symbol">(</a><a id="7314" href="Derivations.html#3277" class="InductiveConstructor">andE₁</a> <a id="7320" href="NfModel.html#7299" class="Bound">t</a><a id="7321" class="Symbol">)</a> <a id="7323" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="7325" href="NfModel.html#7007" class="Function">reflect</a> <a id="7333" href="NfModel.html#7295" class="Bound">B</a> <a id="7335" class="Symbol">(</a><a id="7336" href="Derivations.html#3323" class="InductiveConstructor">andE₂</a> <a id="7342" href="NfModel.html#7299" class="Bound">t</a><a id="7343" class="Symbol">)</a>
  <a id="7347" href="NfModel.html#7007" class="Function">reflect</a> <a id="7355" class="Symbol">(</a><a id="7356" href="NfModel.html#7356" class="Bound">A</a> <a id="7358" href="Formulas.html#269" class="InductiveConstructor Operator">⇒</a> <a id="7360" href="NfModel.html#7360" class="Bound">B</a><a id="7361" class="Symbol">)</a>  <a id="7364" href="NfModel.html#7364" class="Bound">t</a> <a id="7366" href="NfModel.html#7366" class="Bound">τ</a> <a id="7368" href="NfModel.html#7368" class="Bound">a</a> <a id="7370" class="Symbol">=</a> <a id="7372" href="NfModel.html#7007" class="Function">reflect</a> <a id="7380" href="NfModel.html#7360" class="Bound">B</a> <a id="7382" class="Symbol">(</a><a id="7383" href="Derivations.html#3218" class="InductiveConstructor">impE</a> <a id="7388" class="Symbol">(</a><a id="7389" href="Derivations.html#4297" class="Function">monNe</a> <a id="7395" href="NfModel.html#7366" class="Bound">τ</a> <a id="7397" href="NfModel.html#7364" class="Bound">t</a><a id="7398" class="Symbol">)</a> <a id="7400" class="Symbol">(</a><a id="7401" href="NfModel.html#7416" class="Function">reify</a> <a id="7407" href="NfModel.html#7356" class="Bound">A</a> <a id="7409" href="NfModel.html#7368" class="Bound">a</a><a id="7410" class="Symbol">))</a>

  <a id="reify"></a><a id="7416" href="NfModel.html#7416" class="Function">reify</a> <a id="7422" class="Symbol">:</a> <a id="7424" class="Symbol">∀{</a><a id="7426" href="NfModel.html#7426" class="Bound">Γ</a><a id="7427" class="Symbol">}</a> <a id="7429" href="NfModel.html#7429" class="Bound">A</a> <a id="7431" class="Symbol">(</a><a id="7432" href="NfModel.html#7432" class="Bound">⟦f⟧</a> <a id="7436" class="Symbol">:</a> <a id="7438" href="NfModel.html#5943" class="Function Operator">T⟦</a> <a id="7441" href="NfModel.html#7429" class="Bound">A</a> <a id="7443" href="NfModel.html#5943" class="Function Operator">⟧</a> <a id="7445" href="NfModel.html#7426" class="Bound">Γ</a><a id="7446" class="Symbol">)</a> <a id="7448" class="Symbol">→</a> <a id="7450" href="Derivations.html#3373" class="Datatype">Nf</a> <a id="7453" href="NfModel.html#7426" class="Bound">Γ</a> <a id="7455" href="NfModel.html#7429" class="Bound">A</a>
  <a id="7459" href="NfModel.html#7416" class="Function">reify</a> <a id="7465" class="Symbol">(</a><a id="7466" href="Formulas.html#214" class="InductiveConstructor">Atom</a> <a id="7471" href="NfModel.html#7471" class="Bound">P</a><a id="7472" class="Symbol">)</a> <a id="7474" href="NfModel.html#7474" class="Bound">t</a>      <a id="7481" class="Symbol">=</a> <a id="7483" href="NfModel.html#7474" class="Bound">t</a>
  <a id="7487" href="NfModel.html#7416" class="Function">reify</a> <a id="7493" href="Formulas.html#241" class="InductiveConstructor">True</a> <a id="7498" class="Symbol">_</a>          <a id="7509" class="Symbol">=</a> <a id="7511" href="Derivations.html#3879" class="InductiveConstructor">trueI</a>
  <a id="7519" href="NfModel.html#7416" class="Function">reify</a> <a id="7525" href="Formulas.html#246" class="InductiveConstructor">False</a>   <a id="7533" class="Symbol">(</a><a id="7534" href="NfModel.html#7534" class="Bound">c</a> <a id="7536" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="7538" href="NfModel.html#7538" class="Bound">f</a><a id="7539" class="Symbol">)</a> <a id="7541" class="Symbol">=</a> <a id="7543" href="NfModel.html#3897" class="Function">pasteNf</a> <a id="7551" href="NfModel.html#7534" class="Bound">c</a> <a id="7553" class="Symbol">(</a><a id="7554" href="Data.Empty.html#275" class="Function">⊥-elim</a> <a id="7561" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="7563" href="NfModel.html#7538" class="Bound">f</a><a id="7564" class="Symbol">)</a>
  <a id="7568" href="NfModel.html#7416" class="Function">reify</a> <a id="7574" class="Symbol">(</a><a id="7575" href="NfModel.html#7575" class="Bound">A</a> <a id="7577" href="Formulas.html#261" class="InductiveConstructor Operator">∨</a> <a id="7579" href="NfModel.html#7579" class="Bound">B</a><a id="7580" class="Symbol">)</a> <a id="7582" class="Symbol">(</a><a id="7583" href="NfModel.html#7583" class="Bound">c</a> <a id="7585" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="7587" href="NfModel.html#7587" class="Bound">f</a><a id="7588" class="Symbol">)</a> <a id="7590" class="Symbol">=</a> <a id="7592" href="NfModel.html#3897" class="Function">pasteNf</a> <a id="7600" href="NfModel.html#7583" class="Bound">c</a> <a id="7602" class="Symbol">(</a><a id="7603" href="Data.Sum.Base.html#803" class="Function Operator">[</a> <a id="7605" href="Derivations.html#3651" class="InductiveConstructor">orI₁</a> <a id="7610" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="7612" href="NfModel.html#7416" class="Function">reify</a> <a id="7618" href="NfModel.html#7575" class="Bound">A</a> <a id="7620" href="Data.Sum.Base.html#803" class="Function Operator">,</a> <a id="7622" href="Derivations.html#3699" class="InductiveConstructor">orI₂</a> <a id="7627" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="7629" href="NfModel.html#7416" class="Function">reify</a> <a id="7635" href="NfModel.html#7579" class="Bound">B</a> <a id="7637" href="Data.Sum.Base.html#803" class="Function Operator">]</a> <a id="7639" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="7641" href="NfModel.html#7587" class="Bound">f</a><a id="7642" class="Symbol">)</a>
  <a id="7646" href="NfModel.html#7416" class="Function">reify</a> <a id="7652" class="Symbol">(</a><a id="7653" href="NfModel.html#7653" class="Bound">A</a> <a id="7655" href="Formulas.html#265" class="InductiveConstructor Operator">∧</a> <a id="7657" href="NfModel.html#7657" class="Bound">B</a><a id="7658" class="Symbol">)</a> <a id="7660" class="Symbol">(</a><a id="7661" href="NfModel.html#7661" class="Bound">a</a> <a id="7663" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="7665" href="NfModel.html#7665" class="Bound">b</a><a id="7666" class="Symbol">)</a> <a id="7668" class="Symbol">=</a> <a id="7670" href="Derivations.html#3590" class="InductiveConstructor">andI</a> <a id="7675" class="Symbol">(</a><a id="7676" href="NfModel.html#7416" class="Function">reify</a> <a id="7682" href="NfModel.html#7653" class="Bound">A</a> <a id="7684" href="NfModel.html#7661" class="Bound">a</a><a id="7685" class="Symbol">)</a> <a id="7687" class="Symbol">(</a><a id="7688" href="NfModel.html#7416" class="Function">reify</a> <a id="7694" href="NfModel.html#7657" class="Bound">B</a> <a id="7696" href="NfModel.html#7665" class="Bound">b</a><a id="7697" class="Symbol">)</a>
  <a id="7701" href="NfModel.html#7416" class="Function">reify</a> <a id="7707" class="Symbol">(</a><a id="7708" href="NfModel.html#7708" class="Bound">A</a> <a id="7710" href="Formulas.html#269" class="InductiveConstructor Operator">⇒</a> <a id="7712" href="NfModel.html#7712" class="Bound">B</a><a id="7713" class="Symbol">)</a> <a id="7715" href="NfModel.html#7715" class="Bound">⟦f⟧</a>     <a id="7723" class="Symbol">=</a> <a id="7725" href="Derivations.html#3536" class="InductiveConstructor">impI</a> <a id="7730" class="Symbol">(</a><a id="7731" href="NfModel.html#7416" class="Function">reify</a> <a id="7737" href="NfModel.html#7712" class="Bound">B</a> <a id="7739" class="Symbol">(</a><a id="7740" href="NfModel.html#7715" class="Bound">⟦f⟧</a> <a id="7744" class="Symbol">(</a><a id="7745" href="Formulas.html#580" class="InductiveConstructor">weak</a> <a id="7750" href="Formulas.html#667" class="Function">id≤</a><a id="7753" class="Symbol">)</a> <a id="7755" class="Symbol">(</a><a id="7756" href="NfModel.html#7007" class="Function">reflect</a> <a id="7764" href="NfModel.html#7708" class="Bound">A</a> <a id="7766" class="Symbol">(</a><a id="7767" href="Derivations.html#3177" class="InductiveConstructor">hyp</a> <a id="7771" href="Formulas.html#2967" class="InductiveConstructor">top</a><a id="7774" class="Symbol">))))</a>

<a id="7780" class="Comment">-- Semantic paste.</a>

<a id="7800" class="Comment">-- This grafts semantic values f onto a case tree c : Cover Γ.</a>
<a id="7863" class="Comment">-- For atomic propositions, this is grafting of normal forms (defined before).</a>

<a id="paste"></a><a id="7943" href="NfModel.html#7943" class="Function">paste</a> <a id="7949" class="Symbol">:</a> <a id="7951" class="Symbol">∀</a> <a id="7953" href="NfModel.html#7953" class="Bound">A</a> <a id="7955" class="Symbol">{</a><a id="7956" href="NfModel.html#7956" class="Bound">Γ</a><a id="7957" class="Symbol">}</a> <a id="7959" class="Symbol">(</a><a id="7960" href="NfModel.html#7960" class="Bound">c</a> <a id="7962" class="Symbol">:</a> <a id="7964" href="NfModel.html#471" class="Datatype">Cover</a> <a id="7970" href="NfModel.html#7956" class="Bound">Γ</a><a id="7971" class="Symbol">)</a> <a id="7973" class="Symbol">(</a><a id="7974" href="NfModel.html#7974" class="Bound">f</a> <a id="7976" class="Symbol">:</a> <a id="7978" href="NfModel.html#1316" class="Function">All</a> <a id="7982" href="NfModel.html#7960" class="Bound">c</a> <a id="7984" class="Symbol">(</a><a id="7985" href="NfModel.html#5943" class="Function Operator">T⟦</a> <a id="7988" href="NfModel.html#7953" class="Bound">A</a> <a id="7990" href="NfModel.html#5943" class="Function Operator">⟧</a><a id="7991" class="Symbol">))</a> <a id="7994" class="Symbol">→</a> <a id="7996" href="NfModel.html#5943" class="Function Operator">T⟦</a> <a id="7999" href="NfModel.html#7953" class="Bound">A</a> <a id="8001" href="NfModel.html#5943" class="Function Operator">⟧</a> <a id="8003" href="NfModel.html#7956" class="Bound">Γ</a>
<a id="8005" href="NfModel.html#7943" class="Function">paste</a> <a id="8011" class="Symbol">(</a><a id="8012" href="Formulas.html#214" class="InductiveConstructor">Atom</a> <a id="8017" href="NfModel.html#8017" class="Bound">P</a><a id="8018" class="Symbol">)</a> <a id="8020" class="Symbol">=</a> <a id="8022" href="NfModel.html#3897" class="Function">pasteNf</a>
<a id="8030" href="NfModel.html#7943" class="Function">paste</a> <a id="8036" href="Formulas.html#241" class="InductiveConstructor">True</a>     <a id="8045" class="Symbol">=</a> <a id="8047" class="Symbol">_</a>
<a id="8049" href="NfModel.html#7943" class="Function">paste</a> <a id="8055" href="Formulas.html#246" class="InductiveConstructor">False</a>    <a id="8064" class="Symbol">=</a> <a id="8066" href="NfModel.html#5128" class="Function">transCE</a>
<a id="8074" href="NfModel.html#7943" class="Function">paste</a> <a id="8080" class="Symbol">(</a><a id="8081" href="NfModel.html#8081" class="Bound">A</a> <a id="8083" href="Formulas.html#261" class="InductiveConstructor Operator">∨</a> <a id="8085" href="NfModel.html#8085" class="Bound">B</a><a id="8086" class="Symbol">)</a>  <a id="8089" class="Symbol">=</a> <a id="8091" href="NfModel.html#5128" class="Function">transCE</a>
<a id="8099" href="NfModel.html#7943" class="Function">paste</a> <a id="8105" class="Symbol">(</a><a id="8106" href="NfModel.html#8106" class="Bound">A</a> <a id="8108" href="Formulas.html#265" class="InductiveConstructor Operator">∧</a> <a id="8110" href="NfModel.html#8110" class="Bound">B</a><a id="8111" class="Symbol">)</a> <a id="8113" href="NfModel.html#8113" class="Bound">c</a> <a id="8115" href="NfModel.html#8115" class="Bound">f</a> <a id="8117" class="Symbol">=</a> <a id="8119" href="NfModel.html#7943" class="Function">paste</a> <a id="8125" href="NfModel.html#8106" class="Bound">A</a> <a id="8127" href="NfModel.html#8113" class="Bound">c</a> <a id="8129" class="Symbol">(</a><a id="8130" href="Agda.Builtin.Sigma.html#225" class="Field">proj₁</a> <a id="8136" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="8138" href="NfModel.html#8115" class="Bound">f</a><a id="8139" class="Symbol">)</a> <a id="8141" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="8143" href="NfModel.html#7943" class="Function">paste</a> <a id="8149" href="NfModel.html#8110" class="Bound">B</a> <a id="8151" href="NfModel.html#8113" class="Bound">c</a> <a id="8153" class="Symbol">(</a><a id="8154" href="Agda.Builtin.Sigma.html#237" class="Field">proj₂</a> <a id="8160" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="8162" href="NfModel.html#8115" class="Bound">f</a><a id="8163" class="Symbol">)</a>
<a id="8165" href="NfModel.html#7943" class="Function">paste</a> <a id="8171" class="Symbol">(</a><a id="8172" href="NfModel.html#8172" class="Bound">A</a> <a id="8174" href="Formulas.html#269" class="InductiveConstructor Operator">⇒</a> <a id="8176" href="NfModel.html#8176" class="Bound">B</a><a id="8177" class="Symbol">)</a> <a id="8179" href="NfModel.html#8179" class="Bound">c</a> <a id="8181" href="NfModel.html#8181" class="Bound">f</a> <a id="8183" href="NfModel.html#8183" class="Bound">τ</a> <a id="8185" href="NfModel.html#8185" class="Bound">a</a> <a id="8187" class="Symbol">=</a> <a id="8189" href="NfModel.html#7943" class="Function">paste</a> <a id="8195" href="NfModel.html#8176" class="Bound">B</a> <a id="8197" class="Symbol">(</a><a id="8198" href="NfModel.html#4268" class="Function">monC</a> <a id="8203" href="NfModel.html#8183" class="Bound">τ</a> <a id="8205" href="NfModel.html#8179" class="Bound">c</a><a id="8206" class="Symbol">)</a> <a id="8208" class="Symbol">λ</a> <a id="8210" class="Symbol">{</a><a id="8211" href="NfModel.html#8211" class="Bound">Δ</a><a id="8212" class="Symbol">}</a> <a id="8214" href="NfModel.html#8214" class="Bound">e</a> <a id="8216" class="Symbol">→</a>
  <a id="8220" class="Keyword">let</a> <a id="8224" href="NfModel.html#8224" class="Bound">Ψ</a> <a id="8226" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="8228" href="NfModel.html#8228" class="Bound">e&#39;</a> <a id="8231" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="8233" href="NfModel.html#8233" class="Bound">σ</a>  <a id="8236" class="Symbol">=</a> <a id="8238" href="NfModel.html#4685" class="Function">mon∈</a> <a id="8243" href="NfModel.html#8179" class="Bound">c</a> <a id="8245" href="NfModel.html#8183" class="Bound">τ</a> <a id="8247" href="NfModel.html#8214" class="Bound">e</a>
  <a id="8251" class="Keyword">in</a>  <a id="8255" href="NfModel.html#8181" class="Bound">f</a> <a id="8257" href="NfModel.html#8228" class="Bound">e&#39;</a> <a id="8260" href="NfModel.html#8233" class="Bound">σ</a> <a id="8262" class="Symbol">(</a><a id="8263" href="NfModel.html#6407" class="Function">monT</a> <a id="8268" href="NfModel.html#8172" class="Bound">A</a> <a id="8270" class="Symbol">(</a><a id="8271" href="NfModel.html#1776" class="Function">coverWk</a> <a id="8279" href="NfModel.html#8214" class="Bound">e</a><a id="8280" class="Symbol">)</a> <a id="8282" href="NfModel.html#8185" class="Bound">a</a><a id="8283" class="Symbol">)</a>

<a id="8286" class="Comment">-- Fundamental theorem</a>
<a id="8309" class="Comment">-- Extension of T⟦_⟧ to contexts</a>

<a id="G⟦_⟧"></a><a id="8343" href="NfModel.html#8343" class="Function Operator">G⟦_⟧</a> <a id="8348" class="Symbol">:</a> <a id="8350" class="Symbol">∀</a> <a id="8352" class="Symbol">(</a><a id="8353" href="NfModel.html#8353" class="Bound">Γ</a> <a id="8355" href="NfModel.html#8355" class="Bound">Δ</a> <a id="8357" class="Symbol">:</a> <a id="8359" href="Formulas.html#406" class="Datatype">Cxt</a><a id="8362" class="Symbol">)</a> <a id="8364" class="Symbol">→</a> <a id="8366" class="PrimitiveType">Set</a>
<a id="8370" href="NfModel.html#8343" class="Function Operator">G⟦</a> <a id="8373" href="Formulas.html#424" class="InductiveConstructor">ε</a>     <a id="8379" href="NfModel.html#8343" class="Function Operator">⟧</a> <a id="8381" href="NfModel.html#8381" class="Bound">Δ</a> <a id="8383" class="Symbol">=</a> <a id="8385" href="Agda.Builtin.Unit.html#137" class="Record">⊤</a>
<a id="8387" href="NfModel.html#8343" class="Function Operator">G⟦</a> <a id="8390" href="NfModel.html#8390" class="Bound">Γ</a> <a id="8392" href="Formulas.html#434" class="InductiveConstructor Operator">∙</a> <a id="8394" href="NfModel.html#8394" class="Bound">A</a> <a id="8396" href="NfModel.html#8343" class="Function Operator">⟧</a> <a id="8398" href="NfModel.html#8398" class="Bound">Δ</a> <a id="8400" class="Symbol">=</a> <a id="8402" href="NfModel.html#8343" class="Function Operator">G⟦</a> <a id="8405" href="NfModel.html#8390" class="Bound">Γ</a> <a id="8407" href="NfModel.html#8343" class="Function Operator">⟧</a> <a id="8409" href="NfModel.html#8398" class="Bound">Δ</a> <a id="8411" href="Data.Product.html#1167" class="Function Operator">×</a> <a id="8413" href="NfModel.html#5943" class="Function Operator">T⟦</a> <a id="8416" href="NfModel.html#8394" class="Bound">A</a> <a id="8418" href="NfModel.html#5943" class="Function Operator">⟧</a> <a id="8420" href="NfModel.html#8398" class="Bound">Δ</a>

<a id="8423" class="Comment">-- monG : ∀{Γ Δ Φ} (τ : Φ ≤ Δ) → G⟦ Γ ⟧ Δ → G⟦ Γ ⟧ Φ</a>

<a id="monG"></a><a id="8477" href="NfModel.html#8477" class="Function">monG</a> <a id="8482" class="Symbol">:</a> <a id="8484" class="Symbol">∀{</a><a id="8486" href="NfModel.html#8486" class="Bound">Γ</a><a id="8487" class="Symbol">}</a> <a id="8489" class="Symbol">→</a> <a id="8491" href="Formulas.html#3040" class="Function">Mon</a> <a id="8495" href="NfModel.html#8343" class="Function Operator">G⟦</a> <a id="8498" href="NfModel.html#8486" class="Bound">Γ</a> <a id="8500" href="NfModel.html#8343" class="Function Operator">⟧</a>
<a id="8502" href="NfModel.html#8477" class="Function">monG</a> <a id="8507" class="Symbol">{</a><a id="8508" href="Formulas.html#424" class="InductiveConstructor">ε</a><a id="8509" class="Symbol">}</a> <a id="8511" href="NfModel.html#8511" class="Bound">τ</a> <a id="8513" class="Symbol">_</a> <a id="8515" class="Symbol">=</a> <a id="8517" class="Symbol">_</a>
<a id="8519" href="NfModel.html#8477" class="Function">monG</a> <a id="8524" class="Symbol">{</a><a id="8525" href="NfModel.html#8525" class="Bound">Γ</a> <a id="8527" href="Formulas.html#434" class="InductiveConstructor Operator">∙</a> <a id="8529" href="NfModel.html#8529" class="Bound">A</a><a id="8530" class="Symbol">}</a> <a id="8532" href="NfModel.html#8532" class="Bound">τ</a> <a id="8534" class="Symbol">(</a><a id="8535" href="NfModel.html#8535" class="Bound">γ</a> <a id="8537" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="8539" href="NfModel.html#8539" class="Bound">a</a><a id="8540" class="Symbol">)</a> <a id="8542" class="Symbol">=</a> <a id="8544" href="NfModel.html#8477" class="Function">monG</a> <a id="8549" href="NfModel.html#8532" class="Bound">τ</a> <a id="8551" href="NfModel.html#8535" class="Bound">γ</a> <a id="8553" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="8555" href="NfModel.html#6407" class="Function">monT</a> <a id="8560" href="NfModel.html#8529" class="Bound">A</a> <a id="8562" href="NfModel.html#8532" class="Bound">τ</a> <a id="8564" href="NfModel.html#8539" class="Bound">a</a>

<a id="8567" class="Comment">-- Variable case.</a>

<a id="fundH"></a><a id="8586" href="NfModel.html#8586" class="Function">fundH</a> <a id="8592" class="Symbol">:</a> <a id="8594" class="Symbol">∀{</a><a id="8596" href="NfModel.html#8596" class="Bound">Γ</a> <a id="8598" href="NfModel.html#8598" class="Bound">Δ</a> <a id="8600" href="NfModel.html#8600" class="Bound">A</a><a id="8601" class="Symbol">}</a> <a id="8603" class="Symbol">(</a><a id="8604" href="NfModel.html#8604" class="Bound">x</a> <a id="8606" class="Symbol">:</a> <a id="8608" href="Formulas.html#2926" class="Datatype">Hyp</a> <a id="8612" href="NfModel.html#8600" class="Bound">A</a> <a id="8614" href="NfModel.html#8596" class="Bound">Γ</a><a id="8615" class="Symbol">)</a> <a id="8617" class="Symbol">(</a><a id="8618" href="NfModel.html#8618" class="Bound">γ</a> <a id="8620" class="Symbol">:</a> <a id="8622" href="NfModel.html#8343" class="Function Operator">G⟦</a> <a id="8625" href="NfModel.html#8596" class="Bound">Γ</a> <a id="8627" href="NfModel.html#8343" class="Function Operator">⟧</a> <a id="8629" href="NfModel.html#8598" class="Bound">Δ</a><a id="8630" class="Symbol">)</a> <a id="8632" class="Symbol">→</a> <a id="8634" href="NfModel.html#5943" class="Function Operator">T⟦</a> <a id="8637" href="NfModel.html#8600" class="Bound">A</a> <a id="8639" href="NfModel.html#5943" class="Function Operator">⟧</a> <a id="8641" href="NfModel.html#8598" class="Bound">Δ</a>
<a id="8643" href="NfModel.html#8586" class="Function">fundH</a> <a id="8649" href="Formulas.html#2967" class="InductiveConstructor">top</a>     <a id="8657" class="Symbol">=</a> <a id="8659" href="Agda.Builtin.Sigma.html#237" class="Field">proj₂</a>
<a id="8665" href="NfModel.html#8586" class="Function">fundH</a> <a id="8671" class="Symbol">(</a><a id="8672" href="Formulas.html#2996" class="InductiveConstructor">pop</a> <a id="8676" href="NfModel.html#8676" class="Bound">x</a><a id="8677" class="Symbol">)</a> <a id="8679" class="Symbol">=</a> <a id="8681" href="NfModel.html#8586" class="Function">fundH</a> <a id="8687" href="NfModel.html#8676" class="Bound">x</a> <a id="8689" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="8691" href="Agda.Builtin.Sigma.html#225" class="Field">proj₁</a>

<a id="8698" class="Comment">-- A lemma for the orE case.</a>

<a id="orElim"></a><a id="8728" href="NfModel.html#8728" class="Function">orElim</a> <a id="8735" class="Symbol">:</a> <a id="8737" class="Symbol">∀</a> <a id="8739" class="Symbol">{</a><a id="8740" href="NfModel.html#8740" class="Bound">Γ</a> <a id="8742" href="NfModel.html#8742" class="Bound">A</a> <a id="8744" href="NfModel.html#8744" class="Bound">B</a> <a id="8746" href="NfModel.html#8746" class="Bound">E</a><a id="8747" class="Symbol">}</a> <a id="8749" class="Symbol">→</a> <a id="8751" href="NfModel.html#5943" class="Function Operator">T⟦</a> <a id="8754" href="NfModel.html#8742" class="Bound">A</a> <a id="8756" href="Formulas.html#261" class="InductiveConstructor Operator">∨</a> <a id="8758" href="NfModel.html#8744" class="Bound">B</a> <a id="8760" href="NfModel.html#5943" class="Function Operator">⟧</a> <a id="8762" href="NfModel.html#8740" class="Bound">Γ</a> <a id="8764" class="Symbol">→</a>
         <a id="8775" class="Symbol">(∀{</a><a id="8778" href="NfModel.html#8778" class="Bound">Δ</a><a id="8779" class="Symbol">}</a> <a id="8781" class="Symbol">(</a><a id="8782" href="NfModel.html#8782" class="Bound">τ</a> <a id="8784" class="Symbol">:</a> <a id="8786" href="NfModel.html#8778" class="Bound">Δ</a> <a id="8788" href="Formulas.html#533" class="Datatype Operator">≤</a> <a id="8790" href="NfModel.html#8740" class="Bound">Γ</a><a id="8791" class="Symbol">)</a> <a id="8793" class="Symbol">→</a> <a id="8795" href="NfModel.html#5943" class="Function Operator">T⟦</a> <a id="8798" href="NfModel.html#8742" class="Bound">A</a> <a id="8800" href="NfModel.html#5943" class="Function Operator">⟧</a> <a id="8802" href="NfModel.html#8778" class="Bound">Δ</a> <a id="8804" class="Symbol">→</a> <a id="8806" href="NfModel.html#5943" class="Function Operator">T⟦</a> <a id="8809" href="NfModel.html#8746" class="Bound">E</a> <a id="8811" href="NfModel.html#5943" class="Function Operator">⟧</a> <a id="8813" href="NfModel.html#8778" class="Bound">Δ</a><a id="8814" class="Symbol">)</a> <a id="8816" class="Symbol">→</a>
         <a id="8827" class="Symbol">(∀{</a><a id="8830" href="NfModel.html#8830" class="Bound">Δ</a><a id="8831" class="Symbol">}</a> <a id="8833" class="Symbol">(</a><a id="8834" href="NfModel.html#8834" class="Bound">τ</a> <a id="8836" class="Symbol">:</a> <a id="8838" href="NfModel.html#8830" class="Bound">Δ</a> <a id="8840" href="Formulas.html#533" class="Datatype Operator">≤</a> <a id="8842" href="NfModel.html#8740" class="Bound">Γ</a><a id="8843" class="Symbol">)</a> <a id="8845" class="Symbol">→</a> <a id="8847" href="NfModel.html#5943" class="Function Operator">T⟦</a> <a id="8850" href="NfModel.html#8744" class="Bound">B</a> <a id="8852" href="NfModel.html#5943" class="Function Operator">⟧</a> <a id="8854" href="NfModel.html#8830" class="Bound">Δ</a> <a id="8856" class="Symbol">→</a> <a id="8858" href="NfModel.html#5943" class="Function Operator">T⟦</a> <a id="8861" href="NfModel.html#8746" class="Bound">E</a> <a id="8863" href="NfModel.html#5943" class="Function Operator">⟧</a> <a id="8865" href="NfModel.html#8830" class="Bound">Δ</a><a id="8866" class="Symbol">)</a> <a id="8868" class="Symbol">→</a>
         <a id="8879" href="NfModel.html#5943" class="Function Operator">T⟦</a> <a id="8882" href="NfModel.html#8746" class="Bound">E</a> <a id="8884" href="NfModel.html#5943" class="Function Operator">⟧</a> <a id="8886" href="NfModel.html#8740" class="Bound">Γ</a>
<a id="8888" href="NfModel.html#8728" class="Function">orElim</a> <a id="8895" class="Symbol">(</a><a id="8896" href="NfModel.html#8896" class="Bound">c</a> <a id="8898" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="8900" href="NfModel.html#8900" class="Bound">f</a><a id="8901" class="Symbol">)</a> <a id="8903" href="NfModel.html#8903" class="Bound">g</a> <a id="8905" href="NfModel.html#8905" class="Bound">h</a> <a id="8907" class="Symbol">=</a> <a id="8909" href="NfModel.html#7943" class="Function">paste</a> <a id="8915" class="Symbol">_</a> <a id="8917" href="NfModel.html#8896" class="Bound">c</a> <a id="8919" class="Symbol">λ</a> <a id="8921" href="NfModel.html#8921" class="Bound">e</a> <a id="8923" class="Symbol">→</a> <a id="8925" href="Function.Base.html#3544" class="Function Operator">case</a> <a id="8930" href="NfModel.html#8900" class="Bound">f</a> <a id="8932" href="NfModel.html#8921" class="Bound">e</a> <a id="8934" href="Function.Base.html#3544" class="Function Operator">of</a> <a id="8937" href="Data.Sum.Base.html#803" class="Function Operator">[</a> <a id="8939" href="NfModel.html#8903" class="Bound">g</a> <a id="8941" class="Symbol">(</a><a id="8942" href="NfModel.html#1776" class="Function">coverWk</a> <a id="8950" href="NfModel.html#8921" class="Bound">e</a><a id="8951" class="Symbol">)</a> <a id="8953" href="Data.Sum.Base.html#803" class="Function Operator">,</a> <a id="8955" href="NfModel.html#8905" class="Bound">h</a> <a id="8957" class="Symbol">(</a><a id="8958" href="NfModel.html#1776" class="Function">coverWk</a> <a id="8966" href="NfModel.html#8921" class="Bound">e</a><a id="8967" class="Symbol">)</a> <a id="8969" href="Data.Sum.Base.html#803" class="Function Operator">]</a>

<a id="8972" class="Comment">-- A lemma for the falseE case.</a>

<a id="9005" class="Comment">-- Casts an empty cover into any semantic value (by contradiction).</a>

<a id="falseElim"></a><a id="9074" href="NfModel.html#9074" class="Function">falseElim</a> <a id="9084" class="Symbol">:</a> <a id="9086" class="Symbol">∀{</a><a id="9088" href="NfModel.html#9088" class="Bound">Γ</a> <a id="9090" href="NfModel.html#9090" class="Bound">A</a><a id="9091" class="Symbol">}</a> <a id="9093" class="Symbol">→</a> <a id="9095" href="NfModel.html#5943" class="Function Operator">T⟦</a> <a id="9098" href="Formulas.html#246" class="InductiveConstructor">False</a> <a id="9104" href="NfModel.html#5943" class="Function Operator">⟧</a> <a id="9106" href="NfModel.html#9088" class="Bound">Γ</a> <a id="9108" class="Symbol">→</a> <a id="9110" href="NfModel.html#5943" class="Function Operator">T⟦</a> <a id="9113" href="NfModel.html#9090" class="Bound">A</a> <a id="9115" href="NfModel.html#5943" class="Function Operator">⟧</a> <a id="9117" href="NfModel.html#9088" class="Bound">Γ</a>
<a id="9119" href="NfModel.html#9074" class="Function">falseElim</a> <a id="9129" class="Symbol">(</a><a id="9130" href="NfModel.html#9130" class="Bound">c</a> <a id="9132" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="9134" href="NfModel.html#9134" class="Bound">f</a><a id="9135" class="Symbol">)</a> <a id="9137" class="Symbol">=</a> <a id="9139" href="NfModel.html#7943" class="Function">paste</a> <a id="9145" class="Symbol">_</a> <a id="9147" href="NfModel.html#9130" class="Bound">c</a> <a id="9149" class="Symbol">(</a><a id="9150" href="Data.Empty.html#275" class="Function">⊥-elim</a> <a id="9157" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="9159" href="NfModel.html#9134" class="Bound">f</a><a id="9160" class="Symbol">)</a>

<a id="9163" class="Comment">-- The fundamental theorem</a>

<a id="fund"></a><a id="9191" href="NfModel.html#9191" class="Function">fund</a> <a id="9196" class="Symbol">:</a>  <a id="9199" class="Symbol">∀{</a><a id="9201" href="NfModel.html#9201" class="Bound">Γ</a> <a id="9203" href="NfModel.html#9203" class="Bound">A</a><a id="9204" class="Symbol">}</a> <a id="9206" class="Symbol">(</a><a id="9207" href="NfModel.html#9207" class="Bound">t</a> <a id="9209" class="Symbol">:</a> <a id="9211" href="NfModel.html#9201" class="Bound">Γ</a> <a id="9213" href="Derivations.html#230" class="Datatype Operator">⊢</a> <a id="9215" href="NfModel.html#9203" class="Bound">A</a><a id="9216" class="Symbol">)</a> <a id="9218" class="Symbol">{</a><a id="9219" href="NfModel.html#9219" class="Bound">Δ</a><a id="9220" class="Symbol">}</a> <a id="9222" class="Symbol">(</a><a id="9223" href="NfModel.html#9223" class="Bound">γ</a> <a id="9225" class="Symbol">:</a> <a id="9227" href="NfModel.html#8343" class="Function Operator">G⟦</a> <a id="9230" href="NfModel.html#9201" class="Bound">Γ</a> <a id="9232" href="NfModel.html#8343" class="Function Operator">⟧</a> <a id="9234" href="NfModel.html#9219" class="Bound">Δ</a><a id="9235" class="Symbol">)</a> <a id="9237" class="Symbol">→</a> <a id="9239" href="NfModel.html#5943" class="Function Operator">T⟦</a> <a id="9242" href="NfModel.html#9203" class="Bound">A</a> <a id="9244" href="NfModel.html#5943" class="Function Operator">⟧</a> <a id="9246" href="NfModel.html#9219" class="Bound">Δ</a>
<a id="9248" href="NfModel.html#9191" class="Function">fund</a> <a id="9253" class="Symbol">(</a><a id="9254" href="Derivations.html#271" class="InductiveConstructor">hyp</a> <a id="9258" href="NfModel.html#9258" class="Bound">x</a><a id="9259" class="Symbol">)</a>           <a id="9271" class="Symbol">=</a> <a id="9273" href="NfModel.html#8586" class="Function">fundH</a> <a id="9279" href="NfModel.html#9258" class="Bound">x</a>
<a id="9281" href="NfModel.html#9191" class="Function">fund</a> <a id="9286" class="Symbol">(</a><a id="9287" href="Derivations.html#309" class="InductiveConstructor">impI</a> <a id="9292" href="NfModel.html#9292" class="Bound">t</a><a id="9293" class="Symbol">)</a>    <a id="9298" href="NfModel.html#9298" class="Bound">γ</a> <a id="9300" href="NfModel.html#9300" class="Bound">τ</a> <a id="9302" href="NfModel.html#9302" class="Bound">a</a> <a id="9304" class="Symbol">=</a> <a id="9306" href="NfModel.html#9191" class="Function">fund</a> <a id="9311" href="NfModel.html#9292" class="Bound">t</a> <a id="9313" class="Symbol">(</a><a id="9314" href="NfModel.html#8477" class="Function">monG</a> <a id="9319" href="NfModel.html#9300" class="Bound">τ</a> <a id="9321" href="NfModel.html#9298" class="Bound">γ</a> <a id="9323" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="9325" href="NfModel.html#9302" class="Bound">a</a><a id="9326" class="Symbol">)</a>
<a id="9328" href="NfModel.html#9191" class="Function">fund</a> <a id="9333" class="Symbol">(</a><a id="9334" href="Derivations.html#355" class="InductiveConstructor">impE</a> <a id="9339" href="NfModel.html#9339" class="Bound">t</a> <a id="9341" href="NfModel.html#9341" class="Bound">u</a><a id="9342" class="Symbol">)</a>  <a id="9345" href="NfModel.html#9345" class="Bound">γ</a>     <a id="9351" class="Symbol">=</a> <a id="9353" href="NfModel.html#9191" class="Function">fund</a> <a id="9358" href="NfModel.html#9339" class="Bound">t</a> <a id="9360" href="NfModel.html#9345" class="Bound">γ</a> <a id="9362" href="Formulas.html#667" class="Function">id≤</a> <a id="9366" class="Symbol">(</a><a id="9367" href="NfModel.html#9191" class="Function">fund</a> <a id="9372" href="NfModel.html#9341" class="Bound">u</a> <a id="9374" href="NfModel.html#9345" class="Bound">γ</a><a id="9375" class="Symbol">)</a>
<a id="9377" href="NfModel.html#9191" class="Function">fund</a> <a id="9382" class="Symbol">(</a><a id="9383" href="Derivations.html#409" class="InductiveConstructor">andI</a> <a id="9388" href="NfModel.html#9388" class="Bound">t</a> <a id="9390" href="NfModel.html#9390" class="Bound">u</a><a id="9391" class="Symbol">)</a>  <a id="9394" href="NfModel.html#9394" class="Bound">γ</a>     <a id="9400" class="Symbol">=</a> <a id="9402" href="NfModel.html#9191" class="Function">fund</a> <a id="9407" href="NfModel.html#9388" class="Bound">t</a> <a id="9409" href="NfModel.html#9394" class="Bound">γ</a> <a id="9411" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="9413" href="NfModel.html#9191" class="Function">fund</a> <a id="9418" href="NfModel.html#9390" class="Bound">u</a> <a id="9420" href="NfModel.html#9394" class="Bound">γ</a>
<a id="9422" href="NfModel.html#9191" class="Function">fund</a> <a id="9427" class="Symbol">(</a><a id="9428" href="Derivations.html#463" class="InductiveConstructor">andE₁</a> <a id="9434" href="NfModel.html#9434" class="Bound">t</a><a id="9435" class="Symbol">)</a>         <a id="9445" class="Symbol">=</a> <a id="9447" href="Agda.Builtin.Sigma.html#225" class="Field">proj₁</a> <a id="9453" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="9455" href="NfModel.html#9191" class="Function">fund</a> <a id="9460" href="NfModel.html#9434" class="Bound">t</a>
<a id="9462" href="NfModel.html#9191" class="Function">fund</a> <a id="9467" class="Symbol">(</a><a id="9468" href="Derivations.html#505" class="InductiveConstructor">andE₂</a> <a id="9474" href="NfModel.html#9474" class="Bound">t</a><a id="9475" class="Symbol">)</a>         <a id="9485" class="Symbol">=</a> <a id="9487" href="Agda.Builtin.Sigma.html#237" class="Field">proj₂</a> <a id="9493" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="9495" href="NfModel.html#9191" class="Function">fund</a> <a id="9500" href="NfModel.html#9474" class="Bound">t</a>
<a id="9502" href="NfModel.html#9191" class="Function">fund</a> <a id="9507" class="Symbol">(</a><a id="9508" href="Derivations.html#547" class="InductiveConstructor">orI₁</a> <a id="9513" href="NfModel.html#9513" class="Bound">t</a><a id="9514" class="Symbol">)</a>    <a id="9519" href="NfModel.html#9519" class="Bound">γ</a>     <a id="9525" class="Symbol">=</a> <a id="9527" href="NfModel.html#501" class="InductiveConstructor">hole</a> <a id="9532" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="9534" href="Data.Sum.Base.html#667" class="InductiveConstructor">inj₁</a> <a id="9539" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="9541" class="Symbol">λ{</a> <a id="9544" href="NfModel.html#988" class="InductiveConstructor">here</a> <a id="9549" class="Symbol">→</a> <a id="9551" href="NfModel.html#9191" class="Function">fund</a> <a id="9556" href="NfModel.html#9513" class="Bound">t</a> <a id="9558" href="NfModel.html#9519" class="Bound">γ</a> <a id="9560" class="Symbol">}</a>
<a id="9562" href="NfModel.html#9191" class="Function">fund</a> <a id="9567" class="Symbol">(</a><a id="9568" href="Derivations.html#589" class="InductiveConstructor">orI₂</a> <a id="9573" href="NfModel.html#9573" class="Bound">t</a><a id="9574" class="Symbol">)</a>    <a id="9579" href="NfModel.html#9579" class="Bound">γ</a>     <a id="9585" class="Symbol">=</a> <a id="9587" href="NfModel.html#501" class="InductiveConstructor">hole</a> <a id="9592" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="9594" href="Data.Sum.Base.html#692" class="InductiveConstructor">inj₂</a> <a id="9599" href="Function.Base.html#992" class="Function Operator">∘</a> <a id="9601" class="Symbol">λ{</a> <a id="9604" href="NfModel.html#988" class="InductiveConstructor">here</a> <a id="9609" class="Symbol">→</a> <a id="9611" href="NfModel.html#9191" class="Function">fund</a> <a id="9616" href="NfModel.html#9573" class="Bound">t</a> <a id="9618" href="NfModel.html#9579" class="Bound">γ</a> <a id="9620" class="Symbol">}</a>
<a id="9622" href="NfModel.html#9191" class="Function">fund</a> <a id="9627" class="Symbol">(</a><a id="9628" href="Derivations.html#631" class="InductiveConstructor">orE</a> <a id="9632" href="NfModel.html#9632" class="Bound">t</a> <a id="9634" href="NfModel.html#9634" class="Bound">u</a> <a id="9636" href="NfModel.html#9636" class="Bound">v</a><a id="9637" class="Symbol">)</a> <a id="9639" href="NfModel.html#9639" class="Bound">γ</a>     <a id="9645" class="Symbol">=</a> <a id="9647" href="NfModel.html#8728" class="Function">orElim</a> <a id="9654" class="Symbol">(</a><a id="9655" href="NfModel.html#9191" class="Function">fund</a> <a id="9660" href="NfModel.html#9632" class="Bound">t</a> <a id="9662" href="NfModel.html#9639" class="Bound">γ</a><a id="9663" class="Symbol">)</a>
  <a id="9667" class="Symbol">(λ</a> <a id="9670" href="NfModel.html#9670" class="Bound">τ</a> <a id="9672" href="NfModel.html#9672" class="Bound">a</a> <a id="9674" class="Symbol">→</a> <a id="9676" href="NfModel.html#9191" class="Function">fund</a> <a id="9681" href="NfModel.html#9634" class="Bound">u</a> <a id="9683" class="Symbol">(</a><a id="9684" href="NfModel.html#8477" class="Function">monG</a> <a id="9689" href="NfModel.html#9670" class="Bound">τ</a> <a id="9691" href="NfModel.html#9639" class="Bound">γ</a> <a id="9693" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="9695" href="NfModel.html#9672" class="Bound">a</a><a id="9696" class="Symbol">))</a>
  <a id="9701" class="Symbol">(λ</a> <a id="9704" href="NfModel.html#9704" class="Bound">τ</a> <a id="9706" href="NfModel.html#9706" class="Bound">b</a> <a id="9708" class="Symbol">→</a> <a id="9710" href="NfModel.html#9191" class="Function">fund</a> <a id="9715" href="NfModel.html#9636" class="Bound">v</a> <a id="9717" class="Symbol">(</a><a id="9718" href="NfModel.html#8477" class="Function">monG</a> <a id="9723" href="NfModel.html#9704" class="Bound">τ</a> <a id="9725" href="NfModel.html#9639" class="Bound">γ</a> <a id="9727" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="9729" href="NfModel.html#9706" class="Bound">b</a><a id="9730" class="Symbol">))</a>
<a id="9733" href="NfModel.html#9191" class="Function">fund</a> <a id="9738" class="Symbol">(</a><a id="9739" href="Derivations.html#707" class="InductiveConstructor">falseE</a> <a id="9746" href="NfModel.html#9746" class="Bound">t</a><a id="9747" class="Symbol">)</a>  <a id="9750" href="NfModel.html#9750" class="Bound">γ</a>     <a id="9756" class="Symbol">=</a> <a id="9758" href="NfModel.html#9074" class="Function">falseElim</a> <a id="9768" class="Symbol">(</a><a id="9769" href="NfModel.html#9191" class="Function">fund</a> <a id="9774" href="NfModel.html#9746" class="Bound">t</a> <a id="9776" href="NfModel.html#9750" class="Bound">γ</a><a id="9777" class="Symbol">)</a>
<a id="9779" href="NfModel.html#9191" class="Function">fund</a> <a id="9784" href="Derivations.html#747" class="InductiveConstructor">trueI</a>       <a id="9796" href="NfModel.html#9796" class="Bound">γ</a>     <a id="9802" class="Symbol">=</a> <a id="9804" class="Symbol">_</a>

<a id="9807" class="Comment">-- Identity environment</a>

<a id="ide"></a><a id="9832" href="NfModel.html#9832" class="Function">ide</a> <a id="9836" class="Symbol">:</a> <a id="9838" class="Symbol">∀</a> <a id="9840" href="NfModel.html#9840" class="Bound">Γ</a> <a id="9842" class="Symbol">→</a> <a id="9844" href="NfModel.html#8343" class="Function Operator">G⟦</a> <a id="9847" href="NfModel.html#9840" class="Bound">Γ</a> <a id="9849" href="NfModel.html#8343" class="Function Operator">⟧</a> <a id="9851" href="NfModel.html#9840" class="Bound">Γ</a>
<a id="9853" href="NfModel.html#9832" class="Function">ide</a> <a id="9857" href="Formulas.html#424" class="InductiveConstructor">ε</a> <a id="9859" class="Symbol">=</a> <a id="9861" class="Symbol">_</a>
<a id="9863" href="NfModel.html#9832" class="Function">ide</a> <a id="9867" class="Symbol">(</a><a id="9868" href="NfModel.html#9868" class="Bound">Γ</a> <a id="9870" href="Formulas.html#434" class="InductiveConstructor Operator">∙</a> <a id="9872" href="NfModel.html#9872" class="Bound">A</a><a id="9873" class="Symbol">)</a> <a id="9875" class="Symbol">=</a> <a id="9877" href="NfModel.html#8477" class="Function">monG</a> <a id="9882" class="Symbol">(</a><a id="9883" href="Formulas.html#580" class="InductiveConstructor">weak</a> <a id="9888" href="Formulas.html#667" class="Function">id≤</a><a id="9891" class="Symbol">)</a> <a id="9893" class="Symbol">(</a><a id="9894" href="NfModel.html#9832" class="Function">ide</a> <a id="9898" href="NfModel.html#9868" class="Bound">Γ</a><a id="9899" class="Symbol">)</a> <a id="9901" href="Agda.Builtin.Sigma.html#209" class="InductiveConstructor Operator">,</a> <a id="9903" href="NfModel.html#7007" class="Function">reflect</a> <a id="9911" href="NfModel.html#9872" class="Bound">A</a> <a id="9913" class="Symbol">(</a><a id="9914" href="Derivations.html#3177" class="InductiveConstructor">hyp</a> <a id="9918" href="Formulas.html#2967" class="InductiveConstructor">top</a><a id="9921" class="Symbol">)</a>

<a id="9924" class="Comment">-- Normalization</a>

<a id="norm"></a><a id="9942" href="NfModel.html#9942" class="Function">norm</a> <a id="9947" class="Symbol">:</a> <a id="9949" class="Symbol">∀{</a><a id="9951" href="NfModel.html#9951" class="Bound">Γ</a> <a id="9953" href="NfModel.html#9953" class="Bound">A</a><a id="9954" class="Symbol">}</a> <a id="9956" class="Symbol">(</a><a id="9957" href="NfModel.html#9957" class="Bound">t</a> <a id="9959" class="Symbol">:</a> <a id="9961" href="NfModel.html#9951" class="Bound">Γ</a> <a id="9963" href="Derivations.html#230" class="Datatype Operator">⊢</a> <a id="9965" href="NfModel.html#9953" class="Bound">A</a><a id="9966" class="Symbol">)</a> <a id="9968" class="Symbol">→</a> <a id="9970" href="Derivations.html#3373" class="Datatype">Nf</a> <a id="9973" href="NfModel.html#9951" class="Bound">Γ</a> <a id="9975" href="NfModel.html#9953" class="Bound">A</a>
<a id="9977" href="NfModel.html#9942" class="Function">norm</a> <a id="9982" href="NfModel.html#9982" class="Bound">t</a> <a id="9984" class="Symbol">=</a> <a id="9986" href="NfModel.html#7416" class="Function">reify</a> <a id="9992" class="Symbol">_</a> <a id="9994" class="Symbol">(</a><a id="9995" href="NfModel.html#9191" class="Function">fund</a> <a id="10000" href="NfModel.html#9982" class="Bound">t</a> <a id="10002" class="Symbol">(</a><a id="10003" href="NfModel.html#9832" class="Function">ide</a> <a id="10007" class="Symbol">_))</a>

<a id="10012" class="Comment">-- Q.E.D. -}</a>
</pre></body></html>